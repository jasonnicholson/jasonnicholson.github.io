<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Jason H. Nicholson</title>
<link>https://jasonhnicholson.com/blog.html</link>
<atom:link href="https://jasonhnicholson.com/blog.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.8.26</generator>
<lastBuildDate>Sun, 21 Dec 2025 05:00:00 GMT</lastBuildDate>
<item>
  <title>Summary of a second order cavitation model</title>
  <link>https://jasonhnicholson.com/posts/2025/12/2025-12-21-summary-of-a-second-order-cavitation-model.html</link>
  <description><![CDATA[ 





<p>This post was AI generated to help summarize the key aspects of a second-order cavitation model proposed by <span class="citation" data-cites="liu2025implementation">(Liu, Wang, and Liu 2026)</span>. My quick take is this is more advanced model than I need for hydraulic simulations for now.</p>
<p>This is a summary of Liu, Wang, and Liu’s cavitation model that (i) retains the second-order bubble inertia term from the Rayleigh–Plesset equation and (ii) accounts for non‑condensable gas (NCG) effects through physically meaningful parameters. The authors implement the model in OpenFOAM and validate it on two canonical benchmarks: cavitation over a NACA0015 hydrofoil and cavitation‑induced choked flow in a venturi tube <span class="citation" data-cites="liu2025implementation">(Liu, Wang, and Liu 2026)</span>.</p>
<section id="motivation" class="level2">
<h2 class="anchored" data-anchor-id="motivation">Motivation</h2>
<p>Most homogeneous (Euler–Euler) cavitation models used in practical CFD are built around a transport equation for vapor volume fraction with a <em>closure</em> for the phase‑change source term. Common closures are derived from simplified or linearized bubble dynamics, and they often rely on empirical constants tuned per case.</p>
<p>Liu et al.&nbsp;argue that two pieces of physics are especially important in many engineering flows:</p>
<ul>
<li><strong>Nonlinear bubble inertia</strong> during growth/collapse (acceleration/deceleration phases), which is dropped when the second‑order inertial term is neglected.</li>
<li><strong>Non‑condensable gas content</strong>, which can materially affect stability of nuclei and collapse dynamics.</li>
</ul>
</section>
<section id="what-the-model-changes" class="level2">
<h2 class="anchored" data-anchor-id="what-the-model-changes">What the model changes</h2>
<p>The paper stays within a standard homogeneous mixture framework (mixture continuity + momentum + vapor transport). The key change is the <em>mass‑transfer source term</em>.</p>
<section id="secondorder-inertia-retained" class="level3">
<h3 class="anchored" data-anchor-id="secondorder-inertia-retained">1) Second‑order inertia retained</h3>
<p>Instead of using a purely first‑order bubble growth law, the authors start from a more complete Rayleigh–Plesset formulation and retain the second‑order inertial contribution. Practically, this introduces a stronger nonlinearity into the collapse/condensation behavior, which they later link to improved predictions of re‑entrant jet dynamics and cavity shedding <span class="citation" data-cites="liu2025implementation">(Liu, Wang, and Liu 2026)</span>.</p>
</section>
<section id="ncg-enters-via-physically-interpretable-parameters" class="level3">
<h3 class="anchored" data-anchor-id="ncg-enters-via-physically-interpretable-parameters">2) NCG enters via physically interpretable parameters</h3>
<p>Rather than introducing (or tuning) purely empirical rate constants, the model is parameterized around quantities with clearer physical meaning:</p>
<ul>
<li>A <strong>critical nucleus/bubble radius</strong> (a stability threshold for nuclei).</li>
<li>A <strong>molar density of non‑condensable gas</strong> in the mixture.</li>
</ul>
<p>NCG is <em>not</em> treated as its own transported species; instead, its effect is folded into the phase‑change rate expression. The authors frame this as a pragmatic trade‑off: capture first‑order NCG influence without the cost/complexity of a fully miscible multicomponent formulation.</p>
</section>
<section id="evaporation-vs-condensation-behavior" class="level3">
<h3 class="anchored" data-anchor-id="evaporation-vs-condensation-behavior">3) Evaporation vs condensation behavior</h3>
<p>The source term is split into evaporation and condensation contributions based on whether local pressure is below/above the saturation vapor pressure. A key design choice is that the condensation behavior becomes strongly nonlinear in vapor fraction, suppressing “too‑rapid” collapse in near‑pure vapor regions and shifting condensation to behave more like an interfacial process.</p>
</section>
</section>
<section id="implementation-details-as-used-in-the-paper" class="level2">
<h2 class="anchored" data-anchor-id="implementation-details-as-used-in-the-paper">Implementation details (as used in the paper)</h2>
<ul>
<li>Solver: OpenFOAM’s <code>interPhaseChangeFoam</code> (homogeneous cavitation framework).</li>
<li>Test cases:
<ul>
<li><strong>Case A</strong>: 2D NACA0015 hydrofoil (multiple angles of attack and cavitation numbers).</li>
<li><strong>Case B</strong>: 2D (axisymmetric half‑domain) venturi tube (multiple pressure ratios).</li>
</ul></li>
<li>Turbulence: SST <img src="https://latex.codecogs.com/png.latex?k">–<img src="https://latex.codecogs.com/png.latex?%5Comega">; for hydrofoil morphology they also use a Reboud-type correction for eddy viscosity.</li>
<li>The paper uses representative parameter values for the new physical knobs (e.g., a micrometer-scale initial nucleus radius and an NCG molar density within a plausible range for air in water) <span class="citation" data-cites="liu2025implementation">(Liu, Wang, and Liu 2026)</span>.</li>
</ul>
</section>
<section id="validation-results-what-improved" class="level2">
<h2 class="anchored" data-anchor-id="validation-results-what-improved">Validation results: what improved</h2>
<section id="naca0015-hydrofoil" class="level3">
<h3 class="anchored" data-anchor-id="naca0015-hydrofoil">NACA0015 hydrofoil</h3>
<p>Across the hydrofoil comparisons, the paper’s main claim is: <strong>global loads and surface pressure are closer to experiments</strong>, especially around inception/development where many models struggle.</p>
<p>Notable reported behaviors:</p>
<ul>
<li><strong>Lift/drag</strong>: the proposed model generally predicts lift and drag trends that better match experimental data than Schnerr–Sauer, and it places the onset/threshold for “effectively non‑cavitating” conditions closer to experiment in the tested sets.</li>
<li><strong>Pressure coefficient</strong>: predictions near the leading edge are smoother and closer to measurements; Schnerr–Sauer shows stronger non‑physical oscillations in some regimes.</li>
<li><strong>Unsteady shedding and re‑entrant jet</strong>: the proposed model tends to produce a more intense re‑entrant jet and a bubble/cavity collapse process that looks more realistic compared to available experimental visualizations.</li>
</ul>
<p>The paper also notes a limitation: in some <strong>very intense cavitation / low cavitation number</strong> scenarios, the model can over‑extend the cavity (a reminder that Euler–Euler closures + finite grid resolution can struggle to represent fine-scale bubble clouds and sharp interfaces).</p>
</section>
<section id="venturi-tube-cavitationinduced-choked-flow" class="level3">
<h3 class="anchored" data-anchor-id="venturi-tube-cavitationinduced-choked-flow">Venturi tube (cavitation‑induced choked flow)</h3>
<p>The venturi case focuses on the “choked” regime where increasing upstream driving no longer increases mass flow once cavitation becomes established.</p>
<p>Key outcomes reported:</p>
<ul>
<li><strong>Critical pressure ratio</strong> for onset of cavitation‑induced choking is predicted closer to experiment than Schnerr–Sauer.</li>
<li><strong>Dominant oscillation frequency</strong> of vapor dynamics at a representative pressure ratio (around 0.5) is closer to the measured value.</li>
<li><strong>Cavity closure morphology</strong>: the model better reproduces a jagged/oblique cavity-termination structure near the wall, attributed to a stronger re‑entrant jet.</li>
</ul>
</section>
</section>
<section id="takeaways" class="level2">
<h2 class="anchored" data-anchor-id="takeaways">Takeaways</h2>
<ul>
<li>Keeping the <strong>second‑order inertia term</strong> changes the <em>shape</em> of the closure, not just a constant factor; it can materially affect collapse and shedding dynamics.</li>
<li>Encoding NCG effects via a small number of <strong>physically interpretable knobs</strong> is attractive for engineering CFD workflows, even if it is not a full multicomponent model.</li>
<li>The model seems to help most where many closures struggle: inception/transition regimes and unsteady cavity break‑up.</li>
</ul>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-liu2025implementation" class="csl-entry">
Liu, Jianhao, Lianzhou Wang, and Xinyu Liu. 2026. <span>“Implementation and Validation of a Cavitation Model with Bubble Inertia Second-Order Term and Non-Condensable Gas Effects.”</span> <em>International Journal of Multiphase Flow</em> 195: 105524. <a href="https://doi.org/10.1016/j.ijmultiphaseflow.2025.105524">https://doi.org/10.1016/j.ijmultiphaseflow.2025.105524</a>.
</div>
</div>


</section>

 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2025/12/2025-12-21-summary-of-a-second-order-cavitation-model.html</guid>
  <pubDate>Sun, 21 Dec 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>The full cavitation model with only NCG (no vapor)</title>
  <link>https://jasonhnicholson.com/posts/2025/12/2025-12-21-the-full-cavitation-model-with-only-ncg.html</link>
  <description><![CDATA[ 





<p>This note takes the <span class="citation" data-cites="singhal2002full">Singhal et al. (2002)</span> <em>homogeneous-mixture</em> framework and explicitly <strong>turns off the vapor/cavitation part</strong> (no vapor phase, no phase change). What remains is a two-constituent EVET mixture: <strong>liquid + non-condensable gas (NCG)</strong>.</p>
<p>The model is a homogeneous mixture (Equal-Velocity / Equal-Temperature; EVET) formulation:</p>
<ul>
<li>One mixture momentum equation (variable density)</li>
<li>One scalar transport equation for non-condensable gas mass fraction</li>
<li>Algebraic mixture closure for density (liquid + NCG)</li>
</ul>
<section id="primary-variables" class="level2">
<h2 class="anchored" data-anchor-id="primary-variables">Primary variables</h2>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5Crho"> mixture density</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BV%7D"> mixture velocity</li>
<li><img src="https://latex.codecogs.com/png.latex?f_g"> non-condensable gas mass fraction</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Crho_g"> NCG density</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Calpha_g"> NCG volume fraction</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Calpha_l"> liquid volume fraction</li>
</ul>
</section>
<section id="mixture-closure-liquid-ncg-only" class="level2">
<h2 class="anchored" data-anchor-id="mixture-closure-liquid-ncg-only">Mixture closure (liquid + NCG only)</h2>
<p>With vapor ignored (set <img src="https://latex.codecogs.com/png.latex?f_v=0"> everywhere), the mixture density relation reduces to:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B1%7D%7B%5Crho%7D=%5Cfrac%7Bf_g%7D%7B%5Crho_g%7D+%5Cfrac%7B1-f_g%7D%7B%5Crho_l%7D%0A"></p>
<p>NCG density is computed as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Crho_g=%5Cfrac%7BP%7D%7BR_%7Bair%7DT%7D%0A"></p>
<p>The corresponding <em>volume fractions</em> follow from the same algebra used in the full model:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Calpha_g=f_g%5C,%5Cfrac%7B%5Crho%7D%7B%5Crho_g%7D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Calpha_l=1-%5Calpha_g%0A"></p>
</section>
<section id="ncg-mass-fraction-transport-no-phase-change" class="level2">
<h2 class="anchored" data-anchor-id="ncg-mass-fraction-transport-no-phase-change">NCG mass fraction transport (no phase change)</h2>
<p>In this vapor-off limit there are <strong>no</strong> evaporation/condensation source terms. The transported scalar is the NCG mass fraction <img src="https://latex.codecogs.com/png.latex?f_g">:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20t%7D(%5Crho%20f_g)+%5Cnabla%5Ccdot(%5Crho%5C,%5Cmathbf%7BV%7D%5C,f_g)=%5Cnabla%5Ccdot(%5CGamma%5C,%5Cnabla%20f_g)%0A"></p>
<p>Here <img src="https://latex.codecogs.com/png.latex?%5CGamma"> is an effective diffusion coefficient used for the scalar transport (typically a turbulence-model-based closure in CFD implementations).</p>
</section>
<section id="what-this-is-and-is-not" class="level2">
<h2 class="anchored" data-anchor-id="what-this-is-and-is-not">What this is (and is not)</h2>
<ul>
<li>This is still an EVET <em>homogeneous mixture</em> (one velocity, one temperature, variable density).</li>
<li>It is <strong>not</strong> a cavitation model anymore in the classic fluid-mechanics sense, because cavitation refers to the formation of <strong>vapor-filled</strong> cavities when local pressure falls below the liquid vapor pressure, and the associated collapse when pressure recovers (<span class="citation" data-cites="brennen1995cavitation">Brennen (1995)</span>).</li>
</ul>
<p>In hydraulics practice it’s common to associate cavitation damage with “air” because:</p>
<ul>
<li>Entrained/dissolved gas provides nuclei and strongly influences how cavities grow/collapse.</li>
<li>Some phenomena are more properly called <em>aeration/ventilation</em> (gas ingestion/entrained bubbles) rather than vapor cavitation; Brennen explicitly distinguishes air entrainment (“ventilation”) from vaporization-driven cavities in the historical context of propellers (<span class="citation" data-cites="brennen1995cavitation">Brennen (1995)</span>).</li>
</ul>
<p>So: a liquid+air (NCG) mixture model can still be useful for predicting density/compressibility effects, but by itself it does not model vaporization/condensation.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-brennen1995cavitation" class="csl-entry">
Brennen, Christopher Earls. 1995. <em>Cavitation and Bubble Dynamics</em>. Oxford University Press. <a href="http://caltechbook.library.caltech.edu/1/">http://caltechbook.library.caltech.edu/1/</a>.
</div>
<div id="ref-singhal2002full" class="csl-entry">
Singhal, Ashok K., Mohan M. Athavale, Huiying Li, and Yong Jiang. 2002. <span>“Mathematical Basis and Validation of the Full Cavitation Model.”</span> <em>Journal of Fluids Engineering</em> 124 (3): 617–24.
</div>
</div>


</section>

 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2025/12/2025-12-21-the-full-cavitation-model-with-only-ncg.html</guid>
  <pubDate>Sun, 21 Dec 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Summary of the full cavitation model</title>
  <link>https://jasonhnicholson.com/posts/2025/12/2025-12-20-summary-the-full-cavitation-model.html</link>
  <description><![CDATA[ 





<p>This post is a code-oriented restatement of the <strong>Full Cavitation Model</strong> from <span class="citation" data-cites="singhal2002full">Singhal et al. (2002)</span>, with the core equations collected in one place.</p>
<p>The model is a homogeneous mixture (Equal-Velocity / Equal-Temperature; EVET) formulation:</p>
<ul>
<li>One mixture momentum equation (variable density)</li>
<li>One scalar transport equation for vapor mass fraction</li>
<li>Algebraic mixture closure for density (and optionally non-condensable gas)</li>
<li>Algebraic source terms for evaporation/condensation derived from a reduced Rayleigh-Plesset argument</li>
</ul>
<section id="primary-variables" class="level2">
<h2 class="anchored" data-anchor-id="primary-variables">Primary variables</h2>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5Crho"> mixture density</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BV%7D"> mixture velocity</li>
<li><img src="https://latex.codecogs.com/png.latex?f"> vapor mass fraction (base model)</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Calpha"> vapor volume fraction</li>
<li><img src="https://latex.codecogs.com/png.latex?R_e">, <img src="https://latex.codecogs.com/png.latex?R_c"> evaporation and condensation source terms</li>
</ul>
<p>When including a non-condensable gas (NCG):</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?f_v"> vapor mass fraction</li>
<li><img src="https://latex.codecogs.com/png.latex?f_g"> non-condensable gas mass fraction</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Crho_g"> NCG density</li>
</ul>
</section>
<section id="mixture-closure-base-model" class="level2">
<h2 class="anchored" data-anchor-id="mixture-closure-base-model">Mixture closure (base model)</h2>
<p>Mixture density is related to vapor mass fraction <img src="https://latex.codecogs.com/png.latex?f"> by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B1%7D%7B%5Crho%7D=%5Cfrac%7Bf%7D%7B%5Crho_v%7D+%5Cfrac%7B1-f%7D%7B%5Crho_l%7D%0A"></p>
<p>Vapor volume fraction is then:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Calpha%20%5Cequiv%20f%5C,%5Cfrac%7B%5Crho%7D%7B%5Crho_v%7D%0A"></p>
</section>
<section id="vapor-mass-fraction-transport" class="level2">
<h2 class="anchored" data-anchor-id="vapor-mass-fraction-transport">Vapor mass fraction transport</h2>
<p>The vapor mass fraction is governed by:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B%5Cpartial%7D%7B%5Cpartial%20t%7D(%5Crho%20f)+%5Cnabla%5Ccdot(%5Crho%5C,%5Cmathbf%7BV%7D%5C,f)=%5Cnabla%5Ccdot(%5CGamma%5C,%5Cnabla%20f)+R_e-R_c%0A"></p>
<p>Here <img src="https://latex.codecogs.com/png.latex?%5CGamma"> is an effective diffusion coefficient used for the scalar transport (typically a turbulence-model-based closure in CFD implementations).</p>
</section>
<section id="phase-change-source-terms-no-ncg" class="level2">
<h2 class="anchored" data-anchor-id="phase-change-source-terms-no-ncg">Phase-change source terms (no NCG)</h2>
<p>Evaporation (vapor generation) rate:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AR_e=C_e%5C,%5Cfrac%7BV_%7Bch%7D%7D%7B%5Csigma%7D%5C,%5Crho_l%5C,%5Crho_v%5Cleft%5B%5Cfrac%7B2%7D%7B3%7D%5C,%5Cfrac%7B(P_v-P)%7D%7B%5Crho_l%7D%5Cright%5D%5E%7B1/2%7D(1-f)%0A"></p>
<p>Condensation rate:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AR_c=C_c%5C,%5Cfrac%7BV_%7Bch%7D%7D%7B%5Csigma%7D%5C,%5Crho_l%5C,%5Crho_l%5Cleft%5B%5Cfrac%7B2%7D%7B3%7D%5C,%5Cfrac%7B(P-P_v)%7D%7B%5Crho_l%7D%5Cright%5D%5E%7B1/2%7Df%0A"></p>
<p>Where:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?P"> is the local pressure</li>
<li><img src="https://latex.codecogs.com/png.latex?P_v"> is the phase-change threshold pressure (see turbulence section below)</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Csigma"> is liquid-vapor surface tension</li>
<li><img src="https://latex.codecogs.com/png.latex?V_%7Bch%7D"> is a characteristic velocity</li>
</ul>
<p>The authors recommend estimating <img src="https://latex.codecogs.com/png.latex?V_%7Bch%7D"> from turbulent kinetic energy:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AV_%7Bch%7D=%5Csqrt%7Bk%7D%0A"></p>
</section>
<section id="effect-of-turbulence-threshold-pressure" class="level2">
<h2 class="anchored" data-anchor-id="effect-of-turbulence-threshold-pressure">Effect of turbulence (threshold pressure)</h2>
<p>The phase-change threshold pressure is raised using turbulent pressure fluctuations:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AP'_%7Bturb%7D=0.39%5C,%5Crho%5C,k%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0AP_v=%5Cleft(P_%7Bsat%7D+%5Cfrac%7BP'_%7Bturb%7D%7D%7B2%7D%5Cright)%0A"></p>
</section>
<section id="extension-non-condensable-gas-ncg" class="level2">
<h2 class="anchored" data-anchor-id="extension-non-condensable-gas-ncg">Extension: non-condensable gas (NCG)</h2>
<p>With NCG, the mixture density relation becomes:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B1%7D%7B%5Crho%7D=%5Cfrac%7Bf_v%7D%7B%5Crho_v%7D+%5Cfrac%7Bf_g%7D%7B%5Crho_g%7D+%5Cfrac%7B1-f_v-f_g%7D%7B%5Crho_l%7D%0A"></p>
<p>NCG density is computed as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Crho_g=%5Cfrac%7BP%7D%7BR_%7Bair%7DT%7D%0A"></p>
<p>Volume fractions are updated as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Calpha_g=f_g%5C,%5Cfrac%7B%5Crho%7D%7B%5Crho_g%7D%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Calpha_l=1-%5Calpha_v-%5Calpha_g%0A"></p>
<p>The paper then rewrites the phase-change rates (replacing <img src="https://latex.codecogs.com/png.latex?V_%7Bch%7D"> with <img src="https://latex.codecogs.com/png.latex?%5Csqrt%7Bk%7D">) as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AR_e=C_e%5C,%5Cfrac%7B%5Csqrt%7Bk%7D%7D%7B%5Csigma%7D%5C,%5Crho_l%5C,%5Crho_v%5Cleft%5B%5Cfrac%7B2%7D%7B3%7D%5C,%5Cfrac%7B(P_v-P)%7D%7B%5Crho_l%7D%5Cright%5D%5E%7B1/2%7D%5Cleft(1-f_v-f_g%5Cright)%0A"></p>
<p>and</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AR_c=%20C_c%5C,%5Cfrac%7B%5Csqrt%7Bk%7D%7D%7B%5Csigma%7D%5C,%5Crho_l%5C,%5Crho_l%5Cleft%5B%5Cfrac%7B2%7D%7B3%7D%5C,%5Cfrac%7B(P-P_v)%7D%7B%5Crho_l%7D%5Cright%5D%5E%7B1/2%7Df_v%0A"></p>
<section id="note-on-an-apparent-inconsistency-in-eq.-24" class="level3">
<h3 class="anchored" data-anchor-id="note-on-an-apparent-inconsistency-in-eq.-24">Note on an apparent inconsistency in Eq. (24)</h3>
<p>There are a couple of error in Eq. (24) of the original paper. Eq (24) is supposed to be a restatement of Eq. (16) with <img src="https://latex.codecogs.com/png.latex?V_%7Bch%7D"> is replaced with <img src="https://latex.codecogs.com/png.latex?%5Csqrt%7Bk%7D">. However, there are two mistakes.</p>
<p>Eq. (16)</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AR_c=C_c%5C,%5Cfrac%7BV_%7Bch%7D%7D%7B%5Csigma%7D%5C,%5Crho_l%5C,%5Crho_l%5Cleft%5B%5Cfrac%7B2%7D%7B3%7D%5C,%5Cfrac%7B(P-P_v)%7D%7B%5Crho_l%7D%5Cright%5D%5E%7B1/2%7Df%0A"></p>
<p>Eq. (24) as printed <img src="https://latex.codecogs.com/png.latex?%0AR_c=%20%7B%5Ccolor%7Bred%7D%7BC_e%7D%7D%5C,%5Cfrac%7B%5Csqrt%7Bk%7D%7D%7B%5Csigma%7D%5C,%5Crho_l%5C,%5Crho_l%5Cleft%5B%5Cfrac%7B2%7D%7B3%7D%5C,%5Cfrac%7B(P-P_v)%7D%7B%5Ccolor%7Bred%7D%7B%5Crho%7D%7D%5Cright%5D%5E%7B1/2%7Df_v%0A"></p>
<p>Eq. (24) corrected: <img src="https://latex.codecogs.com/png.latex?%0AR_c=%20C_c%5C,%5Cfrac%7B%5Csqrt%7Bk%7D%7D%7B%5Csigma%7D%5C,%5Crho_l%5C,%5Crho_l%5Cleft%5B%5Cfrac%7B2%7D%7B3%7D%5C,%5Cfrac%7B(P-P_v)%7D%7B%5Crho_l%7D%5Cright%5D%5E%7B1/2%7Df_v%0A"></p>
</section>
</section>
<section id="recommended-constants" class="level2">
<h2 class="anchored" data-anchor-id="recommended-constants">Recommended constants</h2>
<p><img src="https://latex.codecogs.com/png.latex?%0AC_e=0.02%5Cqquad%20C_c=0.01%0A"></p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0">
<div id="ref-singhal2002full" class="csl-entry">
Singhal, Ashok K., Mohan M. Athavale, Huiying Li, and Yong Jiang. 2002. <span>“Mathematical Basis and Validation of the Full Cavitation Model.”</span> <em>Journal of Fluids Engineering</em> 124 (3): 617–24.
</div>
</div>


</section>

 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2025/12/2025-12-20-summary-the-full-cavitation-model.html</guid>
  <pubDate>Sat, 20 Dec 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Jake’s command line tools</title>
  <link>https://jasonhnicholson.com/posts/2025/12/2025-12-16-jakes-command-line-tools.html</link>
  <description><![CDATA[ 





<p>I have a coworker named Jake who is a big fan of command line tools. Here some of the tools has recommended and I am learning. Below is a list of tools he recommended.</p>
<ul>
<li><a href="https://github.com/wezterm/wezterm">Wezterm</a>
<ul>
<li>Modern terminal emulator with multiplex features built in (no need for tmux)</li>
<li><a href="https://github.com/JakeHandsome/dotfiles/blob/aad557778620eac94b8258d1b9b3be1d13db2550/.config/wezterm/wezterm.lua">Settings</a></li>
</ul></li>
<li><a href="https://github.com/chrisant996/clink">Clink</a>
<ul>
<li>Modern shell for windows, makes using the terminal for finding files or auto completions easy</li>
<li>Settings
<ul>
<li><code>clink set exec_match_style -1</code>
<ul>
<li>This lets you autocomplete any file for executables. Allowing you do to <code>start sln&lt;tab&gt;</code> and have it auto complete to <code>start Dune-ADC-Code.sln</code> which lets me open visual studio from command line (Works for any file type)</li>
</ul></li>
<li><a href="https://github.com/vladimir-kotikov/clink-completions">Clink completions</a>
<ul>
<li>Adds more completions, importart for git operations</li>
</ul></li>
</ul></li>
</ul></li>
<li><a href="https://github.com/starship/starship">Starship</a>
<ul>
<li>Terminal prompt, gives information related to project right in your shell</li>
<li>Settings
<ul>
<li><a href="https://github.com/JakeHandsome/dotfiles/blob/aad557778620eac94b8258d1b9b3be1d13db2550/clink/starship.lua">Clink integration</a></li>
</ul></li>
</ul></li>
<li><a href="https://github.com/ajeetdsouza/zoxide">Zoxide</a>
<ul>
<li>Smarter cd command, lets you type partial paths and fuzzy find previously visited directories</li>
<li>Settings
<ul>
<li><a href="https://github.com/JakeHandsome/dotfiles/blob/aad557778620eac94b8258d1b9b3be1d13db2550/clink/zoxide.lua">Clink integration</a></li>
</ul></li>
</ul></li>
<li><a href="https://github.com/uutils/coreutils">uutils/coreutils</a>
<ul>
<li>Rewrite of GNU coreutils in rust, works for windows. Use the same commands on linux and windows</li>
<li>Settings
<ul>
<li><a href="https://github.com/JakeHandsome/dotfiles/blob/aad557778620eac94b8258d1b9b3be1d13db2550/clink/clink_start.cmd#L5-L7">Clink aliases</a></li>
</ul></li>
</ul></li>
<li>ripgrep (rg) https://github.com/BurntSushi/ripgrep
<ul>
<li>Super fast grep</li>
</ul></li>
<li><a href="https://github.com/sharkdp/fd">fd</a>
<ul>
<li>Super fast file find</li>
</ul></li>
<li><a href="https://github.com/neovim/neovim">neovim</a>
<ul>
<li>Best editor in Jake’s opinion</li>
<li><a href="https://github.com/JakeHandsome/dotfiles/tree/aad557778620eac94b8258d1b9b3be1d13db2550/nvim">Settings</a> (These are personal and you should probably write your own, A good started config is called LazyVim)</li>
</ul></li>
<li><a href="https://github.com/jtroo/kanata/">Kanata</a>
<ul>
<li>Tool for software remapping of keys, I remap CAPSLOCK to ESC to make ESC more reachable</li>
<li><a href="https://github.com/JakeHandsome/dotfiles/blob/aad557778620eac94b8258d1b9b3be1d13db2550/caps2esc.kbd">Settings</a></li>
</ul></li>
<li><a href="https://github.com/gerardog/gsudo">gsudo</a>
<ul>
<li>Adds sudo to windows, its nice. need to make sure to overwrite the default windows 11 sudo</li>
<li>Troubleshooting in win11 https://gerardog.github.io/gsudo/docs/gsudo-vs-sudo#what-if-i-install-both</li>
</ul></li>
<li><a href="https://github.com/sharkdp/bat">bat</a>
<ul>
<li>Upgraded cat command, provide some pretty printing and git context when used</li>
</ul></li>
<li><a href="https://github.com/Wilfred/difftastic">difftastic</a>
<ul>
<li>Better terminal diff tool (My default git diff command, gitdifftool goes to beyond compare)</li>
</ul></li>
</ul>



 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2025/12/2025-12-16-jakes-command-line-tools.html</guid>
  <pubDate>Tue, 16 Dec 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Understanding how damping ratio affects the poles of a second order system</title>
  <link>https://jasonhnicholson.com/posts/2025/12/2025-12-13-understanding-how-damping-ratio-affects-the-poles-of-a-second-order-system.html</link>
  <description><![CDATA[ 





<p>In simulation and controls, its important to understand the details of a second order system. This post is how the damping ratio affect the poles of a second order system.</p>
<p>The mechanical second order system has the following form:</p>
<p><img src="https://latex.codecogs.com/png.latex?m%20%5Cddot%7Bx%7D%20+%20c%20%5Cdot%7Bx%7D%20+%20k%20x%20=%20F(t)"></p>
<p>Where:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?m"> is the mass</li>
<li><img src="https://latex.codecogs.com/png.latex?c"> is the damping coefficient</li>
<li><img src="https://latex.codecogs.com/png.latex?k"> is the spring constant</li>
<li><img src="https://latex.codecogs.com/png.latex?F(t)"> is the external force applied to the system</li>
</ul>
<p>Normalizing the equation by dividing through by <img src="https://latex.codecogs.com/png.latex?m"> gives:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cddot%7Bx%7D%20+%202%20%5Czeta%20%5Comega_n%20%5Cdot%7Bx%7D%20+%20%5Comega_n%5E2%20x%20=%20%5Cfrac%7B1%7D%7Bm%7DF(t)"></p>
<p>Where:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5Comega_n%20=%20%5Csqrt%7B%5Cfrac%7Bk%7D%7Bm%7D%7D"> is the natural frequency</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Czeta%20=%20%5Cfrac%7Bc%7D%7B2%20%5Csqrt%7Bmk%7D%7D"> is the damping ratio</li>
</ul>
<p>Taking the laplace transform with 0 initial conditions gives the transfer function. Note, that the 0 initial conditions can be handled later and that studying the damping ratio effects on the poles is independent of initial conditions.</p>
<p><img src="https://latex.codecogs.com/png.latex?G(s)%20=%20%5Cfrac%7BX(s)%7D%7BF(s)%7D%20=%20%5Cfrac%7B%5Cfrac%7B1%7D%7Bm%7D%7D%7Bs%5E2%20+%202%20%5Czeta%20%5Comega_n%20s%20+%20%5Comega_n%5E2%7D"></p>
<p>The poles of this system represent the roots of the denominator and can be found using the quadratic formula:</p>
<p><img src="https://latex.codecogs.com/png.latex?s%20=%20%5Cfrac%7B-2%20%5Czeta%20%5Comega_n%20%5Cpm%20%5Csqrt%7B(2%20%5Czeta%20%5Comega_n)%5E2%20-%204%20%5Ccdot%201%20%5Ccdot%20%5Comega_n%5E2%7D%7D%7B2%20%5Ccdot%201%7D"></p>
<p>Let’s normalize this expression by dividing through by <img src="https://latex.codecogs.com/png.latex?%5Comega_n"> and simplify the expression:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bs%7D%7B%5Comega_n%7D%20=%20-%5Czeta%20%5Cpm%20%5Csqrt%7B%5Czeta%5E2%20-%201%7D"></p>
<p>What’s important is understanding how the damping ratio <img src="https://latex.codecogs.com/png.latex?%5Czeta"> affects the nature of the poles.</p>
<ol type="1">
<li><strong>No damping (<img src="https://latex.codecogs.com/png.latex?%5Czeta%20=%200">)</strong>:
<ul>
<li>The poles are purely imaginary: <img src="https://latex.codecogs.com/png.latex?s%20=%20%5Cpm%20j%20%5Comega_n">.</li>
<li>This indicates undamped oscillations at the natural frequency <img src="https://latex.codecogs.com/png.latex?%5Comega_n">.</li>
</ul></li>
<li><strong>Underdamped (<img src="https://latex.codecogs.com/png.latex?0%20%3C%20%5Czeta%20%3C%201">)</strong>:
<ul>
<li>The poles are complex conjugates: <img src="https://latex.codecogs.com/png.latex?s%20=%20-%5Czeta%20%5Comega_n%20%5Cpm%20j%20%5Comega_n%20%5Csqrt%7B1%20-%20%5Czeta%5E2%7D">.</li>
<li>This indicates oscillatory behavior with an exponential decay determined by the real part <img src="https://latex.codecogs.com/png.latex?-%5Czeta%20%5Comega_n">.</li>
</ul></li>
<li><strong>Critically damped (<img src="https://latex.codecogs.com/png.latex?%5Czeta%20=%201">)</strong>:
<ul>
<li>The poles are real and repeated: <img src="https://latex.codecogs.com/png.latex?s%20=%20-%5Comega_n">.</li>
<li>This indicates the system returns to equilibrium as quickly as possible without oscillating.</li>
</ul></li>
<li><strong>Overdamped (<img src="https://latex.codecogs.com/png.latex?%5Czeta%20%3E%201">)</strong>:
<ul>
<li>The poles are real and distinct: <img src="https://latex.codecogs.com/png.latex?s%20=%20-%5Czeta%20%5Comega_n%20%5Cpm%20%5Comega_n%20%5Csqrt%7B%5Czeta%5E2%20-%201%7D">.</li>
<li>This indicates a non-oscillatory return to equilibrium, with the speed of return depending primarily on the larger of the two poles.</li>
<li>As the damping ratio goes to infinity, one pole approaches zero while the other goes to negative infinity.</li>
</ul></li>
</ol>
<p>Below is a plot of the poles of a second order system as a function of the damping ratio from 0 to 2. Note how when the poles become real, one pole goes to zero while the other goes to negative infinity as the damping ratio increases.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb1-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeta</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">unique</span>([<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">linspace</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1001</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">linspace</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.';</span></span>
<span id="cb1-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootWithPositiveImaginaryPart</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeta</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootWithNegativeImaginaryPart</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeta</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootWithPositiveImaginaryPart</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'LineWidth'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hold</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">on</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">axis</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">equal</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootWithNegativeImaginaryPart</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'b'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'LineWidth'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xlabel</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Real part of s/\omega_n'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylabel</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Imaginary part of s/\omega_n'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jasonhnicholson.com/posts/2025/12/Figure_1.png" class="img-fluid figure-img"></p>
<figcaption>Poles of a second order system as a function of damping ratio</figcaption>
</figure>
</div>



 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2025/12/2025-12-13-understanding-how-damping-ratio-affects-the-poles-of-a-second-order-system.html</guid>
  <pubDate>Sat, 13 Dec 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>CAE Workstation setup</title>
  <link>https://jasonhnicholson.com/posts/2025/12/2025-12-05-cae-workstation-setup.html</link>
  <description><![CDATA[ 





<ol type="1">
<li>Install Ubuntu 24.04 LTS</li>
<li>Update and upgrade system</li>
<li>Setup VS Code</li>
<li>Setup Curl</li>
<li><a href="https://github.com/JuliaLang/juliaup">Setup julia via juliaup</a></li>
<li><a href="https://github.com/pyenv/pyenv?tab=readme-ov-file">Setup pyenv</a></li>
<li>Install some supporting packages</li>
</ol>
<pre><code>sudo apt install -y \
    build-essential cmake \
    gmsh paraview \
    libopenblas-dev libscalapack-mpi-dev libmumps-dev \
    libhdf5-mpi-dev libfftw3-mpi-dev libptscotch-dev \
    mpi-default-bin mpi-default-dev
snap install freecad</code></pre>
<ol start="8" type="1">
<li>Install Quarto</li>
</ol>
<p>TODO:</p>
<ol start="9" type="1">
<li>Setup Salome-Meca</li>
<li>Setup Elmer</li>
<li>Setup OpenFOAM</li>
</ol>



 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2025/12/2025-12-05-cae-workstation-setup.html</guid>
  <pubDate>Fri, 05 Dec 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Re-encoding a Google photo/video album</title>
  <link>https://jasonhnicholson.com/posts/2025/11/2025-11-30-re-encoding-a-google-photo-video-album.html</link>
  <description><![CDATA[ 





<p>One common issue is running out of space on your smartphone or in the cloud because of photos and videos. Google provides “storage saver” settings that help, but they don’t completely solve the problem. The main issue is that the default video bitrate is around 20 Mbps, which is quite high for most use cases. Re-encoding videos to around 3,000 kbps can drastically reduce their size while maintaining good quality. The same is true for photos, where reducing the resolution and quality can help reduce their size. The space saved by re-encoding is usually around 5–9×, depending on the content. An album that was consuming 20GB will likely come down to around 2–4GB after re-encoding. If you’re starting from “storage saver” quality, the savings will be smaller but still significant at around 2–3×. I use the following workflow to re-encode my Google photo/video albums:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jasonhnicholson.com/posts/2025/11/Screenshot from 2025-11-30 13-05-57.png" class="img-fluid figure-img"></p>
<figcaption>Folder setup</figcaption>
</figure>
</div>
<ol type="1">
<li>Clear my trash in Google Photos. This will help later.</li>
<li>Download the album from Google Photos. Put it into the Large folder.</li>
<li>Run the script below to re-encode the photos and videos into the Small folder.</li>
<li>Send all the videos and photos in the Google Photos album to the trash. Clearing your trash earlier helps recover if you screwed up something. I am telling you from experience.</li>
<li>Use the “Upload from computer” option in the Google Photos album to upload the contents of the Small folder back to the album. Because the metadata is preserved, the photos and videos will appear in the correct order with the correct timestamps.</li>
</ol>
<p>The script below is a Windows batch script that uses <code>ffmpeg</code> and <code>exiftool</code> to re-encode the photos and videos. Make sure you have both tools installed and available in your system PATH. Files are assumed to be .heic or .jpg for pictures and .mp4 for videos. This script can easily be adapted for Bash or other shells as needed. Metadata is maintained for both photos and videos. <code>exiftool</code> is used to copy metadata for photos while removing the Orientation tag to avoid auto-rotation issues. The <code>hevc_nvenc</code> encoder is used for videos to leverage NVIDIA GPU acceleration, if available, for H.265 encoding. If you don’t have an NVIDIA GPU, you can replace <code>hevc_nvenc</code> with <code>libx265</code> for CPU encoding.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bat code-with-copy"><code class="sourceCode dosbat"><span id="cb1-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">@</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo off</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">setlocal</span> enabledelayedexpansion</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_dir</span>=Large</span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span>=Small</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exist</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">%</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">%</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">mkdir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">%</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">%</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> Handling Pictures</span>
<span id="cb1-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">%%f</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">%</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_dir</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">%</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">\*.jpg"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">%</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_dir</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">%</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">\*.heic"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span></span>
<span id="cb1-11">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_file</span>=<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f</span></span>
<span id="cb1-12">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">filename</span>=<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>~nf</span>
<span id="cb1-13"></span>
<span id="cb1-14">     ffmpeg <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-hide_banner</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_file</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">!</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-q:</span>v 6 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-map_metadata</span> 0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-stats</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-update</span> 1 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">%</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">%</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">\</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">filename</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">!</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpg"</span></span>
<span id="cb1-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">rem Copy all metadata from source but remove Orientation to avoid auto-rotation</span></span>
<span id="cb1-16">    exiftool <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-tagsfromfile</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_file</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">!</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-all:</span>all <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-Orientation</span>= <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-overwrite_original</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">%</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">%</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">\</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">filename</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">!</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.jpg"</span></span>
<span id="cb1-17"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb1-18"></span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> Handling videos</span>
<span id="cb1-20"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">%%f</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">%</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_dir</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">%</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">\*.MP4"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span></span>
<span id="cb1-21">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_file</span>=<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f</span></span>
<span id="cb1-22">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">filename</span>=<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>~nf</span>
<span id="cb1-23"></span>
<span id="cb1-24">     ffmpeg <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-hide_banner</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_file</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">!</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c:</span>v hevc_nvenc <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-preset</span> p5 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-cq</span> 35 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-multipass</span> fullres <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-spatial_aq</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-map_metadata</span> 0 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c:</span>a aac <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-b:</span>a 128k <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ac</span> 1 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">%</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">%</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">\</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">!</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">filename</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">!</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.MP4"</span></span>
<span id="cb1-25"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb1-26"></span>
<span id="cb1-27"></span>
<span id="cb1-28"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> Processing complete!</span>
<span id="cb1-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">pause</span></span></code></pre></div></div>



 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2025/11/2025-11-30-re-encoding-a-google-photo-video-album.html</guid>
  <pubDate>Sun, 30 Nov 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Encoding many videos with ffmpeg, handbrake, and nvencc</title>
  <link>https://jasonhnicholson.com/posts/2025/11/2025-11-28-Encoding-many-videos-with-ffmpeg-handbrake-and-nvencc.html</link>
  <description><![CDATA[ 





<p>I was working figure out the best combination of settings for <a href="https://ffmpeg.org/">ffmpeg</a>, <a href="https://handbrake.fr/">handbrake</a>, and <a href="https://github.com/rigaya/NVEnc">nvencc</a> to encode a large number of videos. I wanted to compare the quality and file size of each encoding method. The <code>Just Video.mkv</code> below is the video uncompressed. What I found was that <code>nvencc</code> was the fastest and could be controlled to have similar quality to <code>ffmpeg</code> and <code>handbrake</code> at a fraction of the time.</p>
<div class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-2"></span>
<span id="cb1-3">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_excel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comparison-of-encodings.xlsx"</span>)</span>
<span id="cb1-4">df</span></code></pre></div></div>
</details>
<div id="tbl-encoding-comparison" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="1">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-encoding-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Comparison of encodings
</figcaption>
<div aria-describedby="tbl-encoding-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe do-not-create-environment cell caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Relative path</th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">Size</th>
<th data-quarto-table-cell-role="th">Compression Ratio</th>
<th data-quarto-table-cell-role="th">Encoder</th>
<th data-quarto-table-cell-role="th">library</th>
<th data-quarto-table-cell-role="th">Time to Encode</th>
<th data-quarto-table-cell-role="th">Codec</th>
<th data-quarto-table-cell-role="th">level</th>
<th data-quarto-table-cell-role="th">preset</th>
<th data-quarto-table-cell-role="th">Qualtiy/crf</th>
<th data-quarto-table-cell-role="th">cqp</th>
<th data-quarto-table-cell-role="th">AQ</th>
<th data-quarto-table-cell-role="th">Lookahead</th>
<th data-quarto-table-cell-role="th">b frames</th>
<th data-quarto-table-cell-role="th">b ref mode</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>test20.mkv</td>
<td>2022-12-05 00:06:50</td>
<td>165178477</td>
<td>30.907239</td>
<td>handbrake</td>
<td>x265</td>
<td>01:02:32</td>
<td>h.265</td>
<td>auto</td>
<td>slow</td>
<td>28.0</td>
<td>NaN</td>
<td>NaN</td>
<td>25.0</td>
<td>4.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>test21.mkv</td>
<td>2022-12-05 00:20:50</td>
<td>217591441</td>
<td>23.462369</td>
<td>handbrake</td>
<td>x264</td>
<td>00:13:58</td>
<td>h.264</td>
<td>3.1</td>
<td>medium</td>
<td>28.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>test10.mkv</td>
<td>2022-12-04 20:27:04</td>
<td>353531237</td>
<td>14.440621</td>
<td>nvencc</td>
<td>nvencc</td>
<td>00:02:31</td>
<td>h.265</td>
<td>auto</td>
<td>P7</td>
<td>NaN</td>
<td>20:28:28</td>
<td>on</td>
<td>32.0</td>
<td>0.0</td>
<td>disabled</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>test01.mkv</td>
<td>2022-12-04 19:37:40</td>
<td>357186733</td>
<td>14.292834</td>
<td>nvencc</td>
<td>nvencc</td>
<td>00:01:51</td>
<td>h.265</td>
<td>auto</td>
<td>P1</td>
<td>NaN</td>
<td>1 day, 0:28:28</td>
<td>off</td>
<td>32.0</td>
<td>0.0</td>
<td>disabled</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>test08.mkv</td>
<td>2022-12-05 11:25:08</td>
<td>357499168</td>
<td>14.280343</td>
<td>nvencc</td>
<td>nvencc</td>
<td>00:02:06</td>
<td>h.265</td>
<td>auto</td>
<td>P4</td>
<td>NaN</td>
<td>20:28:28</td>
<td>on</td>
<td>32.0</td>
<td>0.0</td>
<td>disabled</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>test09.mkv</td>
<td>2022-12-04 20:23:55</td>
<td>372688029</td>
<td>13.698349</td>
<td>nvencc</td>
<td>nvencc</td>
<td>00:02:09</td>
<td>h.265</td>
<td>auto</td>
<td>P1</td>
<td>NaN</td>
<td>20:28:28</td>
<td>on</td>
<td>32.0</td>
<td>0.0</td>
<td>disabled</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>test17.mkv</td>
<td>2022-12-04 21:07:59</td>
<td>407170602</td>
<td>12.538259</td>
<td>nvencc</td>
<td>nvencc</td>
<td>00:02:00</td>
<td>h.264</td>
<td>auto</td>
<td>P4</td>
<td>NaN</td>
<td>20:28:28</td>
<td>off</td>
<td>0.0</td>
<td>3.0</td>
<td>disabled</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>test13.mkv</td>
<td>2022-12-04 20:44:10</td>
<td>414758133</td>
<td>12.308886</td>
<td>nvencc</td>
<td>nvencc</td>
<td>00:02:12</td>
<td>h.264</td>
<td>auto</td>
<td>P4</td>
<td>NaN</td>
<td>20:28:28</td>
<td>on</td>
<td>32.0</td>
<td>3.0</td>
<td>disabled</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>test14.mkv</td>
<td>2022-12-04 20:58:13</td>
<td>415904717</td>
<td>12.274952</td>
<td>nvencc</td>
<td>nvencc</td>
<td>00:02:54</td>
<td>h.264</td>
<td>auto</td>
<td>P7</td>
<td>NaN</td>
<td>20:28:28</td>
<td>on</td>
<td>32.0</td>
<td>3.0</td>
<td>disabled</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>test22.mkv</td>
<td>2022-12-05 00:25:16</td>
<td>427046059</td>
<td>11.954707</td>
<td>handbrake</td>
<td>nvenc_h264</td>
<td>00:04:24</td>
<td>h.264</td>
<td>auto</td>
<td>medium</td>
<td>28.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>test16.mkv</td>
<td>2022-12-04 21:05:11</td>
<td>428304164</td>
<td>11.919591</td>
<td>nvencc</td>
<td>nvencc</td>
<td>00:02:13</td>
<td>h.s64</td>
<td>auto</td>
<td>P4</td>
<td>NaN</td>
<td>20:28:28</td>
<td>on</td>
<td>32.0</td>
<td>3.0</td>
<td>each</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>test15.mkv</td>
<td>2022-12-04 21:02:10</td>
<td>431311989</td>
<td>11.836468</td>
<td>nvencc</td>
<td>nvencc</td>
<td>00:02:18</td>
<td>h.264</td>
<td>auto</td>
<td>P4</td>
<td>NaN</td>
<td>20:28:28</td>
<td>on</td>
<td>32.0</td>
<td>4.0</td>
<td>disabled</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">12</th>
<td>test18.mkv</td>
<td>2022-12-04 22:45:10</td>
<td>453180456</td>
<td>11.265293</td>
<td>handbrake</td>
<td>x265</td>
<td>01:28:14.200000</td>
<td>h.265</td>
<td>auto</td>
<td>slow</td>
<td>20.0</td>
<td>NaN</td>
<td>NaN</td>
<td>25.0</td>
<td>4.0</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">13</th>
<td>test23.mkv</td>
<td>2022-12-05 00:30:16</td>
<td>473814634</td>
<td>10.774700</td>
<td>handbrake</td>
<td>nvenc_h265</td>
<td>00:04:58</td>
<td>h.265</td>
<td>auto</td>
<td>medium</td>
<td>28.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14</th>
<td>test24.mkv</td>
<td>NaT</td>
<td>476862830</td>
<td>10.705826</td>
<td>handbrake</td>
<td>nvenc_h265</td>
<td>00:05:19</td>
<td>h.265</td>
<td>auto</td>
<td>medium</td>
<td>28.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">15</th>
<td>test22_2.mkv</td>
<td>NaT</td>
<td>485119066</td>
<td>10.523624</td>
<td>ffmpeg</td>
<td>h264_nvenc</td>
<td>00:02:13</td>
<td>h.264</td>
<td>NaN</td>
<td>medium</td>
<td>28.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">16</th>
<td>test19.mkv</td>
<td>2022-12-04 23:04:16</td>
<td>591502476</td>
<td>8.630920</td>
<td>handbrake</td>
<td>x264</td>
<td>00:19:05</td>
<td>h.264</td>
<td>3.1</td>
<td>medium</td>
<td>20.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">17</th>
<td>test11.mkv</td>
<td>2022-12-04 20:30:02</td>
<td>615034372</td>
<td>8.300692</td>
<td>nvencc</td>
<td>nvencc</td>
<td>00:02:00</td>
<td>h.264</td>
<td>auto</td>
<td>P4</td>
<td>NaN</td>
<td>20:23:25</td>
<td>off</td>
<td>0.0</td>
<td>3.0</td>
<td>disabled</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">18</th>
<td>test05.mkv</td>
<td>2022-12-04 20:06:13</td>
<td>634038978</td>
<td>8.051888</td>
<td>nvencc</td>
<td>nvencc</td>
<td>00:02:25</td>
<td>h.265</td>
<td>auto</td>
<td>P7</td>
<td>NaN</td>
<td>20:23:25</td>
<td>off</td>
<td>0.0</td>
<td>0.0</td>
<td>disabled</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">19</th>
<td>test12.mkv</td>
<td>2022-12-04 20:33:41</td>
<td>635505228</td>
<td>8.033310</td>
<td>nvencc</td>
<td>nvencc</td>
<td>00:02:12</td>
<td>h.264</td>
<td>auto</td>
<td>P4</td>
<td>NaN</td>
<td>20:23:25</td>
<td>on</td>
<td>32.0</td>
<td>3.0</td>
<td>disabled</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">20</th>
<td>test06.mkv</td>
<td>2022-12-04 20:09:54</td>
<td>640328575</td>
<td>7.972798</td>
<td>nvencc</td>
<td>nvencc</td>
<td>00:02:13</td>
<td>h.265</td>
<td>auto</td>
<td>P4</td>
<td>NaN</td>
<td>20:23:25</td>
<td>off</td>
<td>32.0</td>
<td>0.0</td>
<td>disabled</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">21</th>
<td>test02.mkv</td>
<td>2022-12-04 19:46:37</td>
<td>642378626</td>
<td>7.947354</td>
<td>nvencc</td>
<td>nvencc</td>
<td>00:01:50</td>
<td>h.265</td>
<td>auto</td>
<td>P4</td>
<td>NaN</td>
<td>20:23:25</td>
<td>off</td>
<td>0.0</td>
<td>0.0</td>
<td>disabled</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">22</th>
<td>test03.mkv</td>
<td>2022-12-04 19:49:09</td>
<td>642378626</td>
<td>7.947354</td>
<td>nvencc</td>
<td>nvencc</td>
<td>00:01:50</td>
<td>h.265</td>
<td>auto</td>
<td>P4</td>
<td>NaN</td>
<td>20:23:25</td>
<td>off</td>
<td>0.0</td>
<td>0.0</td>
<td>disabled</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">23</th>
<td>test04.mkv</td>
<td>2022-12-04 20:01:42</td>
<td>673475955</td>
<td>7.580390</td>
<td>nvencc</td>
<td>nvencc</td>
<td>00:01:49</td>
<td>h.265</td>
<td>auto</td>
<td>P1</td>
<td>NaN</td>
<td>20:23:25</td>
<td>off</td>
<td>0.0</td>
<td>0.0</td>
<td>disabled</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">24</th>
<td>test07.mkv</td>
<td>2022-12-04 20:15:22</td>
<td>678693704</td>
<td>7.522113</td>
<td>nvencc</td>
<td>nvencc</td>
<td>00:02:07</td>
<td>h.265</td>
<td>auto</td>
<td>P4</td>
<td>NaN</td>
<td>20:23:25</td>
<td>on</td>
<td>32.0</td>
<td>0.0</td>
<td>disabled</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">25</th>
<td>Just Video.mkv</td>
<td>2022-12-20 10:50:46</td>
<td>5105210612</td>
<td>1.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>NaN</td>
<td>-</td>
<td>-</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>Ultimately, this is the command I used to encode many videos with <code>nvencc</code>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode cmd code-with-copy"><code class="sourceCode dosbat"><span id="cb2-1">NVEncC64.exe <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inputfile"</span> -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-video-metadata</span> copy  -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-metadata</span> copy -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-video-metadata</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-2">title=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span> -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-chapter-copy</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> hevc -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-cqp</span> 28 -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-bref-mode</span> disabled -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-preset</span> quality <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-3">-<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-tier</span> high -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-lookahead</span> 32 -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-aq</span> -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-aq-strength</span> 0 -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-level</span> auto -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-colormatrix</span> auto <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-4">-<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-transfer</span> auto -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-colorprim</span> auto -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-output-depth</span> 8 -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-multipass</span> None -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-mv-precision</span> Auto <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-5">-<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-chromaloc</span> auto -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-colorrange</span> auto -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-avsync</span> cfr  -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-audio-metadata</span> 1?language=eng <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-6">-<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-audio-stream</span> 1?:stereo -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-audio-codec</span> 1?ac3 -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-audio-bitrate</span> 1?160  -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-audio-metadata</span> 1?clear <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-7">-<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-audio-metadata</span> 1?title=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Stereo"</span> -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-audio-metadata</span> 1?handler=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Stereo"</span> -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-sub-copy</span> 1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-8">-<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-sub-disposition</span> 1?default -<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-sub-metadata</span>  1?language='eng' <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> default_mode:infer_no_subs </span>
<span id="cb2-9">-o <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"outputfile"</span></span></code></pre></div></div>
<p>The main thing that drives <code>nvencc</code> quality is the <code>--cqp</code> parameter. Lower values give better quality but larger file sizes. Higher values give lower quality but smaller file sizes. I found that <code>--cqp 28</code> gave a good balance of quality and file size. The video looks very similar to the original uncompressed video, but the file size is much smaller. Other configuration corresponds to subtitles, audio tracks, and color settings.</p>



 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2025/11/2025-11-28-Encoding-many-videos-with-ffmpeg-handbrake-and-nvencc.html</guid>
  <pubDate>Fri, 28 Nov 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Setting up a website and email - DNS, GitHub, Markdown</title>
  <link>https://jasonhnicholson.com/posts/2025/11/2025-11-28-setting-up-a-website-and-email.html</link>
  <description><![CDATA[ 





<p>I recently migrated away from BlueHost and WordPress to a static site generator using GitHub Pages and Quarto. I moved my email from Bluehost to <a href="https://purelymail.com/">purelymail.com</a>.The process involved several steps, including setting up DNS records, configuring GitHub, and converting my content to Markdown format. Here’s a brief analysis.</p>
<section id="cost-comparison" class="level2">
<h2 class="anchored" data-anchor-id="cost-comparison">Cost Comparison</h2>
<p>Bluehost was my previous hosting provider, where I had both my website and email services. Bluehost’s business model initial is inexpensive at around $5/month ($180 per 3 year term), but after a few years, it becomes 3x the cost. i.e.&nbsp;It costs me around $540 for hosting for a 3 year term to host a basic website with email. I need a basic site and email so Bluehost was more than I needed. As well, WordPress is a huge time suck. I wanted something simpler. Domains are around $15/year + $15/year for privacy protection from Bluehost. NameCheap charges around $12/year domain and privacy protection. Purelymail.com charges $10 a year for email hosting. GitHub Pages is free for public repositories. Quarto is free for open source projects. Overall, my new setup costs around $22/year. This is a significant cost saving compared to Bluehost.</p>
</section>
<section id="registrar-migration-and-dns-setup-for-github-pages" class="level2">
<h2 class="anchored" data-anchor-id="registrar-migration-and-dns-setup-for-github-pages">Registrar migration and DNS setup for Github Pages</h2>
<p>I moved my domain registration from Bluehost to NameCheap. This was a straightforward. Follow the prompts on the screen.</p>
<p>The following have to be set up in DNS on NameCheap so that it points to GitHub Pages.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Host</th>
<th>Type</th>
<th>Value</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>@</td>
<td>A</td>
<td>185.199.108.153</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>@</td>
<td>A</td>
<td>185.199.109.153</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>@</td>
<td>A</td>
<td>185.199.110.153</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>@</td>
<td>A</td>
<td>185.199.111.153</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>@</td>
<td>AAAA</td>
<td>2606:50c0:8000::153</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>@</td>
<td>AAAA</td>
<td>2606:50c0:8001::153</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>@</td>
<td>AAAA</td>
<td>2606:50c0:8002::153</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>@</td>
<td>AAAA</td>
<td>2606:50c0:8003::153</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>www</td>
<td>CNAME</td>
<td>your-github-username.github.io</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>_GITHUB-PAGES-CHALLENGE-username</td>
<td>TXT</td>
<td><code>token-provided-by-github</code></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><br> For purelymail.com email hosting, I added the following DNS records:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Host</th>
<th>Type</th>
<th>Value</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>@</td>
<td>MX</td>
<td>MAILSERVER.PURELYMAIL.COM</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>PURELYMAIL1._DOMAINKEY</td>
<td>CNAME</td>
<td>KEY1.DKIMROOT.PURELYMAIL.COM</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>PURELYMAIL2._DOMAINKEY</td>
<td>CNAME</td>
<td>KEY2.DKIMROOT.PURELYMAIL.COM</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>PURELYMAIL3._DOMAINKEY</td>
<td>CNAME</td>
<td>KEY3.DKIMROOT.PURELYMAIL.COM</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>_DMARC</td>
<td>CNAME</td>
<td>DMARCROOT.PURELYMAIL.COM</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>@</td>
<td>TXT</td>
<td>purelymail_ownership_proof=<code>token-provided-by-purelymail.com</code></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>@</td>
<td>TXT</td>
<td>v=spf1 include:_spf.purelymail.com ~all</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="githhub-pages-setup" class="level2">
<h2 class="anchored" data-anchor-id="githhub-pages-setup">GithHub Pages setup</h2>
<p>I created a new public repository on GitHub named <code>your-github-username.github.io</code>. This is required for GitHub Pages to work with a custom domain.</p>
<p>I validated my domain ownership by adding the TXT record mentioned above in the DNS setup section.</p>
<p>I configured the repository settings to enable GitHub Pages, selecting the gh-pages branch as the source.</p>
<p>I used a <code>git worktree</code> workflow to deploy the site to the <code>gh-pages</code> branch while keeping the main branch for content development. This has the advantage of allowing you to use Git LFS for large files in the main branch while not use LFS in the gh-pages branch. The deploy script is shown below:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/usr/bin/env julia</span></span>
<span id="cb1-2"></span>
<span id="cb1-3">SITE_DIR <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abspath</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">joinpath</span>(<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@__DIR__</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".."</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_site"</span>))</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@info</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SITE_DIR: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>SITE_DIR<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Minimal deploy script for Quarto sites.</span></span>
<span id="cb1-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Uses `quarto render` to build the site.</span></span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run_cmd</span>(cmd<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">Cmd</span>)</span>
<span id="cb1-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">println</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cmd<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run</span>(cmd)</span>
<span id="cb1-13"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If not running in CI, try to clean up any existing worktree so the</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># script can start from a clean state.</span></span>
<span id="cb1-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> !<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">haskey</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">ENV</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CI"</span>)</span>
<span id="cb1-18">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span></span>
<span id="cb1-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run_cmd</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">`git clean -xfd`</span>)</span>
<span id="cb1-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(SITE_DIR, force<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">true</span>, recursive<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">true</span>)</span>
<span id="cb1-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run_cmd</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">`git worktree remove $SITE_DIR --force`</span>)</span>
<span id="cb1-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run_cmd</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">`git branch -D gh-pages`</span>)</span>
<span id="cb1-23">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">catch</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">e</span></span>
<span id="cb1-24">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ignore if they don't exist</span></span>
<span id="cb1-25">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb1-26"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb1-27"></span>
<span id="cb1-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a gh-pages worktree</span></span>
<span id="cb1-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run_cmd</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">`git worktree add --orphan -B gh-pages $SITE_DIR`</span>)</span>
<span id="cb1-30"></span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Back up the SITE_DIR/.git file (Quarto may wipe it out)</span></span>
<span id="cb1-32">dot_git_file <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">joinpath</span>(SITE_DIR, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".git"</span>)</span>
<span id="cb1-33">dot_git_contents <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">nothing</span></span>
<span id="cb1-34">dot_git_contents <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read</span>(dot_git_file, <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">String</span>)</span>
<span id="cb1-35"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@info</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Backed up </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>dot_git_file<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-36"></span>
<span id="cb1-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Render the Quarto site</span></span>
<span id="cb1-38"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run_cmd</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">`quarto render`</span>)</span>
<span id="cb1-39"></span>
<span id="cb1-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Restore backed-up .git file</span></span>
<span id="cb1-41"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">open</span>(dot_git_file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"w"</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span> io</span>
<span id="cb1-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write</span>(io, dot_git_contents)</span>
<span id="cb1-43"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb1-44"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@info</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Restored </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>dot_git_file<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-45"></span>
<span id="cb1-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get current commit hash</span></span>
<span id="cb1-47">current_hash <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readchomp</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">`git rev-parse --short HEAD`</span>)</span>
<span id="cb1-48"></span>
<span id="cb1-49"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cd</span>(SITE_DIR) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-50">  <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@info</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Current directory: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pwd</span>())<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-51">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span></span>
<span id="cb1-52">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run_cmd</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">`git add --all .`</span>)</span>
<span id="cb1-53">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run_cmd</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">`git commit -m "Deploy Quarto site to gh-pages $current_hash"`</span>)</span>
<span id="cb1-54">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run_cmd</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">`git push --force origin gh-pages`</span>)</span>
<span id="cb1-55">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">catch</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">e</span></span>
<span id="cb1-56">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if there are no changes to commit, continue</span></span>
<span id="cb1-57">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span>  </span>
<span id="cb1-58"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb1-59"></span>
<span id="cb1-60"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> !<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">haskey</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">ENV</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CI"</span>)</span>
<span id="cb1-61">  <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@info</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CI not detected; cleaning up worktree and gh-pages branch"</span></span>
<span id="cb1-62">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span></span>
<span id="cb1-63">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run_cmd</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">`git worktree remove $SITE_DIR --force`</span>)</span>
<span id="cb1-64">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run_cmd</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">`git branch -D gh-pages`</span>)</span>
<span id="cb1-65">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">catch</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">e</span></span>
<span id="cb1-66">    <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@warn</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Failed to clean up: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>e<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-67">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb1-68"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb1-69">  <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@info</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CI detected; skipping worktree cleanup"</span></span>
<span id="cb1-70"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span></code></pre></div></div>


</section>

 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2025/11/2025-11-28-setting-up-a-website-and-email.html</guid>
  <pubDate>Fri, 28 Nov 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Switching to Quarto from Franklin.jl</title>
  <link>https://jasonhnicholson.com/posts/2025/11/2025-11-28-switching-to-quarto-from-franklin.html</link>
  <description><![CDATA[ 





<p>After initially migrating to Franklin.jl in the last several weeks, I migrated again to <a href="https://quarto.org">Quarto</a>. Franklin.jl is okay but Quarto is better. Here are my reasons migrating:</p>
<ul>
<li>Franklin.jl’s support of base Markdown features was lacking. In most static site generators, Markdown is a superset of HTML making the HTML inline with the Markdown. Franklin required <code>~~~</code> blocks to signify HTML blocks. Mixing equations and HTML together is tricky without inline HTML.</li>
<li>Franklin.jl does not have built in search support.</li>
<li>Quarto feels more professional. Less bugs. Less stack traces in the command line or REPL when working with Quarto.</li>
<li>Franklin.jl’s blog support is terrible. I opted for a static blog page in Franklin.jl because I had spent days trying to hack together the right functions to parse the posts. Quarto’s blog functionality worked out of the box.</li>
<li>More formats. Quarto can generate other formats while Franklin.jl cannot.</li>
<li>Franklin.jl’s prerender and minify didn’t always work. As well, adding syntax highlighting for VBA only worked for local rendering. The prerender was so different that I could not easily hack it to get it to work. I gave up and turned prerender off.</li>
<li>Franklin.jl’s understanding of image location is site relative and not relative to where the images are on disk. This makes VSCode’s understanding of location incorrect.</li>
</ul>
<p>I migrated from Franklin.jl to Quarto in a day. I started this morning around 10:00 am. In that time,</p>
<ul>
<li>I learned basic Quarto through tutorials.</li>
<li>Converted 39 .md files to .qmd files.</li>
<li>Fixed all links and image issues.</li>
<li>Updated the deploy script.</li>
</ul>
<p>Thank you Quarto team for a great tool!</p>
<p>Franklin, it’s been nice. Goodbye.</p>



 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2025/11/2025-11-28-switching-to-quarto-from-franklin.html</guid>
  <pubDate>Fri, 28 Nov 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Converting a docx to md - Math, tables, and html</title>
  <link>https://jasonhnicholson.com/posts/2025/11/2025-11-19-converting-docx-to-md.html</link>
  <description><![CDATA[ 





<p>I used pandoc to convert a word file to .md.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">$</span> .venv/bin/pandoc <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f</span> docx <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> gfm <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Newton Method Musings.docx"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--extract-media</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>media <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> Newton-Method-Musings_pandoc.md</span></code></pre></div></div>
<p>The following warnings were generated.</p>
<pre class="plaintext"><code>[WARNING] Could not convert TeX math \frac{\partial F}{\partial x} = 0, rendering as TeX
[WARNING] Could not convert TeX math \frac{\partial F}{\partial x}, rendering as TeX
[WARNING] Could not convert TeX math D = \left( \frac{\partial^{2}F}{\partial x^{2}} \right)^{- 1}\left( - \frac{\partial F}{\partial x} \right), rendering as TeX
[WARNING] Could not convert TeX math \frac{\partial^{2}F}{\partial x^{2}}, rendering as TeX
[WARNING] Could not convert TeX math \frac{\partial^{2}F}{\partial x^{2}}, rendering as TeX
[WARNING] Could not convert TeX math D = \left( \frac{\partial\ F}{\partial x} \right)^{- 1}( - F), rendering as TeX
[WARNING] Could not convert TeX math \frac{\partial\ F}{\partial x}, rendering as TeX
[WARNING] Could not convert TeX math \frac{\partial^{2}F}{\partial x^{2}}, rendering as TeX
[WARNING] Could not convert TeX math \frac{\partial\ F}{\partial x}, rendering as TeX
[WARNING] Could not convert TeX math \frac{\partial\ F}{\partial x}, rendering as TeX</code></pre>
<p>The problem was that the inline TeX inside an html did not get rendered correct like shown below.</p>
<pre class="plaintext"><code>$\frac{\partial F}{\partial x}$</code></pre>
<p>The solution was to convert the <code>$...$</code> to <code>\(...\)</code>.</p>
<pre class="plaintext"><code>\(\frac{\partial F}{\partial x}\)</code></pre>
<p>The context was the following.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb5-1"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">tr</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;"> class</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"even"</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb5-2"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">td</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">p</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span>The gradient is 0 at minimum<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">p</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb5-3"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">p</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">span</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;"> class</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"math display"</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span>$$\frac{\partial F}{\partial x} =</span>
<span id="cb5-4">0$$<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">span</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">p</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb5-5"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">p</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span>Where<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">p</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb5-6"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">p</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span>\(\frac{\partial F}{\partial x}\) is a</span>
<span id="cb5-7">vector value function of the <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">span</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;"> class</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"math inline"</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">em</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span>x<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">em</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">span</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb5-8">vector.<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">p</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">td</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb5-9"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">td</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">p</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">span</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;"> class</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"math display"</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">em</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span>F<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">em</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span>(<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">em</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span>x<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">em</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span>) = 0<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">span</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">p</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb5-10"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">p</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span>Where<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">p</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb5-11"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">ul</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb5-12"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">li</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">p</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">span</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;"> class</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"math inline"</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">em</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span>F<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">em</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span>(<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">em</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span>x<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">em</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span>)<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">span</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span> is a</span>
<span id="cb5-13">vector value function of</span></code></pre></div></div>



 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2025/11/2025-11-19-converting-docx-to-md.html</guid>
  <pubDate>Wed, 19 Nov 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Setting Up a Franklin.jl Blog</title>
  <link>https://jasonhnicholson.com/posts/2025/11/2025-11-11-getting-Franklin_jl_setup.html</link>
  <description><![CDATA[ 





<p>UPDATE 2025-11-28: I migrated to Quarto because of issues like the one below.</p>
<p>Note, that this method is brittle. After I put this into practice and had multiple failures and spent hours and days troubleshooting, I opted for a static blog page that contains static links. I don’t auto generate the page using the code below. I will come back to this after I understand some of the details better. For now, I am not using the method below.</p>
<ol type="1">
<li>Setup a new Franklin site.</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">using</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Franklin</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">newsite</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mySite"</span>, template<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pure-sm"</span>)</span></code></pre></div></div>
<ol start="2" type="1">
<li>Add the following code to your utils.jl file. The <code>newsite()</code> call created the <code>utils.jl</code> file.</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb2-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    {{blogposts}}</span></span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Plug in the list of blog posts contained in the `/blog/` folder.</span></span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Taken from the the julialang.org site and modified.</span></span>
<span id="cb2-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">https://github.com/JuliaLang/www.julialang.org/blob/90de0f3bf314796db210b6faeea55ed360721836/utils.jl#L43-L85</span></span>
<span id="cb2-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb2-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hfun_blogposts</span>()</span>
<span id="cb2-10">  curyear <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">year</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Dates</span>.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">today</span>())</span>
<span id="cb2-11">  io <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">IOBuffer</span>()</span>
<span id="cb2-12">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> year <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> curyear<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2015</span></span>
<span id="cb2-13">    ys <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>year<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb2-14">    year <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> curyear <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write</span>(io, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">**</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>year<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">**</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb2-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> month <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-16">      ms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lpad</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">string</span>(month), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'0'</span>)</span>
<span id="cb2-17">      base <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">joinpath</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blog"</span>, ys, ms)</span>
<span id="cb2-18">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">isdir</span>(base) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb2-19">      posts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter!</span>(p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">endswith</span>(p, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".md"</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readdir</span>(base))</span>
<span id="cb2-20">      nposts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(posts)</span>
<span id="cb2-21">      dates <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Vector</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{Date}</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">undef</span>, nposts)</span>
<span id="cb2-22">      lines <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Vector</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{String}</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">undef</span>, nposts)</span>
<span id="cb2-23">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i, post) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">enumerate</span>(posts)</span>
<span id="cb2-24">        ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">splitext</span>(post)[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb2-25">        url <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/blog/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ys<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ms<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ps<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/"</span></span>
<span id="cb2-26">        surl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strip</span>(url, <span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'/'</span>)</span>
<span id="cb2-27">        title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pagevar</span>(surl, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>title)</span>
<span id="cb2-28">        title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">===</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">nothing</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> (title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Untitled"</span>)</span>
<span id="cb2-29">        date <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pagevar</span>(surl, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>date)</span>
<span id="cb2-30">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># parse published date defensively; fall back to first of month</span></span>
<span id="cb2-31">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">isnothing</span>(date)</span>
<span id="cb2-32">          date <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Date</span>(year, month, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-33">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb2-34">          <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span></span>
<span id="cb2-35">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># expect ISO format: yyyy-mm-dd</span></span>
<span id="cb2-36">            date <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Date</span>(date, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Dates</span>.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DateFormat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yyyy-mm-dd"</span>))</span>
<span id="cb2-37">          <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">catch</span> err1</span>
<span id="cb2-38">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span></span>
<span id="cb2-39">              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># try generic parsing as a fallback</span></span>
<span id="cb2-40">              date <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Date</span>(date)</span>
<span id="cb2-41">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">catch</span> err2</span>
<span id="cb2-42">              <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@warn</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Failed to parse published date; falling back to first of month"</span> surl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> surl pubdate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> date error <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> err2</span>
<span id="cb2-43">              date <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Date</span>(year, month, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-44">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-45">          <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-46">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-47">        dates[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> date</span>
<span id="cb2-48">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># format date as ISO yyyy-mm-dd for output</span></span>
<span id="cb2-49">        lines[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n$</span>date<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> - [</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>title<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">](</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>url<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb2-50">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-51">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sort by full Date (descending) so posts are antichronological</span></span>
<span id="cb2-52">      order <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sortperm</span>(dates, rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">true</span>)</span>
<span id="cb2-53">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">foreach</span>(idx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write</span>(io, lines[idx]), order)</span>
<span id="cb2-54">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-55">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-56">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># markdown conversion adds `&lt;p&gt;` beginning and end but</span></span>
<span id="cb2-57">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we want to avoid this to avoid an empty separator</span></span>
<span id="cb2-58">  r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Franklin.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fd2html</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">String</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">take!</span>(io)), internal<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">true</span>)</span>
<span id="cb2-59">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> r</span>
<span id="cb2-60"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-61"></span>
<span id="cb2-62"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb2-63"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    {{recentblogposts}}</span></span>
<span id="cb2-64"></span>
<span id="cb2-65"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Input the 3 latest blog posts.</span></span>
<span id="cb2-66"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Taken from the the julialang.org site and modified.</span></span>
<span id="cb2-67"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">https://github.com/JuliaLang/www.julialang.org/blob/90de0f3bf314796db210b6faeea55ed360721836/utils.jl#L43-L85</span></span>
<span id="cb2-68"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb2-69"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hfun_recentblogposts</span>()</span>
<span id="cb2-70">  curyear <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Dates</span>.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Year</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Dates</span>.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">today</span>()).value</span>
<span id="cb2-71">  ntofind <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb2-72">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># collect recent posts dynamically; push! as we find them</span></span>
<span id="cb2-73">  recent <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Vector</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{Pair{String,Date}}</span>()</span>
<span id="cb2-74">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> year <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> curyear<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2019</span></span>
<span id="cb2-75">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> month <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-76">      ms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lpad</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">string</span>(month), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">'0'</span>)</span>
<span id="cb2-77">      base <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">joinpath</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blog"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>year<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ms<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb2-78">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">isdir</span>(base) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb2-79">      posts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter!</span>(p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">endswith</span>(p, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".md"</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readdir</span>(base))</span>
<span id="cb2-80">      np <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(posts)</span>
<span id="cb2-81">      dates <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Vector</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{Date}</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">undef</span>, np)</span>
<span id="cb2-82">      surls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Vector</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">{String}</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">undef</span>, np)</span>
<span id="cb2-83">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i, post) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">enumerate</span>(posts)</span>
<span id="cb2-84">        ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">splitext</span>(post)[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb2-85">        surl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blog/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>year<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ms<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ps<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb2-86">        surls[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> surl</span>
<span id="cb2-87">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># check :date front-matter only</span></span>
<span id="cb2-88">        date <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pagevar</span>(surl, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>date)</span>
<span id="cb2-89">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># normalize into a Date; fall back to first of month</span></span>
<span id="cb2-90">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">isnothing</span>(date)</span>
<span id="cb2-91">          d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Date</span>(year, month, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-92">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elseif</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">isa</span>(date, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Dates</span>.<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">Date</span>)</span>
<span id="cb2-93">          d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> date</span>
<span id="cb2-94">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb2-95">          parsed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">nothing</span></span>
<span id="cb2-96">          <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span></span>
<span id="cb2-97">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># expect ISO format yyyy-mm-dd</span></span>
<span id="cb2-98">            parsed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Date</span>(date, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Dates</span>.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DateFormat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yyyy-mm-dd"</span>))</span>
<span id="cb2-99">          <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">catch</span> err1</span>
<span id="cb2-100">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span></span>
<span id="cb2-101">              parsed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Date</span>(date)</span>
<span id="cb2-102">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">catch</span> err2</span>
<span id="cb2-103">              <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">@warn</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Failed to parse recent post date; falling back to first of month"</span> surl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> surl pubdate <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> date error <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> err2</span>
<span id="cb2-104">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-105">          <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-106">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">isnothing</span>(parsed) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> (d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Date</span>(year, month, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> (d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parsed)</span>
<span id="cb2-107">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-108">        dates[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d</span>
<span id="cb2-109">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-110">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># go over month posts in antichronological order by full Date</span></span>
<span id="cb2-111">      sp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sortperm</span>(dates, rev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">true</span>)</span>
<span id="cb2-112">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> sp</span>
<span id="cb2-113">        surl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> surls[idx]</span>
<span id="cb2-114">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">push!</span>(recent, surl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=&gt;</span> dates[idx])</span>
<span id="cb2-115">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(recent) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> ntofind <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span></span>
<span id="cb2-116">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-117">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(recent) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> ntofind <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span></span>
<span id="cb2-118">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-119">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(recent) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> ntofind <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span></span>
<span id="cb2-120">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-121">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb2-122">  io <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">IOBuffer</span>()</span>
<span id="cb2-123">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (surl, date) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> recent</span>
<span id="cb2-124">    url <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>surl<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/"</span></span>
<span id="cb2-125">    title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pagevar</span>(surl, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>title)</span>
<span id="cb2-126">    title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">===</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">nothing</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> (title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Untitled"</span>)</span>
<span id="cb2-127">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check for rss_description first,</span></span>
<span id="cb2-128">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># then fall back to rss.</span></span>
<span id="cb2-129">    rss_description <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pagevar</span>(surl, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>rss_description)</span>
<span id="cb2-130">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">isnothing</span>(rss_description)</span>
<span id="cb2-131">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># some pages may still define `rss` explicitly (edge cases)</span></span>
<span id="cb2-132">      rss_description <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pagevar</span>(surl, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>rss)</span>
<span id="cb2-133">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">isnothing</span>(rss_description)</span>
<span id="cb2-134">        rss_description <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb2-135">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-136">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-137"></span>
<span id="cb2-138">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write</span>(</span>
<span id="cb2-139">      io,</span>
<span id="cb2-140">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb2-141"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;div class="col-lg-4 col-md-12 blog"&gt;</span></span>
<span id="cb2-142"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  &lt;a href="</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>url<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>date<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> - </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>title<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/a&gt;</span></span>
<span id="cb2-143"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  &lt;p&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>rss_description<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/p&gt;</span></span>
<span id="cb2-144"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/div&gt;</span></span>
<span id="cb2-145"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb2-146">    )</span>
<span id="cb2-147">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-148">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">String</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">take!</span>(io))</span>
<span id="cb2-149"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span></code></pre></div></div>
<ol start="2" type="1">
<li>Create <code>blog</code> folder in the root of the new site.</li>
<li>Put an <code>index.md</code> (example below) in the <code>blog</code> folder. The <code>{blogposts}</code> and <code>{recentblogposts}</code> correspond to the <code>hfun_recentblogposts()</code> and <code>hfun_blogposts()</code> functions in <code>util.jl</code>.</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode md code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Recent posts</span></span>
<span id="cb3-2"></span>
<span id="cb3-3">{{recentblogposts}}</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Blog posts</span></span>
<span id="cb3-6"></span>
<span id="cb3-7">{{blogposts}}</span></code></pre></div></div>
<ol start="4" type="1">
<li>Create <code>yyyy/mm</code> folders in a <code>blog</code> folders. If you don’t follow this format exact, the provided <code>hfun_recentblogposts()</code> and <code>hfun_blogposts()</code> won’t find your posts.</li>
<li>Place your posts in the <code>yyyy/mm</code> folder. Names don’t matter.</li>
<li>Make sure to define a Front Matters section for each post. The Front Matters must contain a <code>title</code> and <code>date</code> for the post to get parsed correctly by the <code>hfun_blogposts()</code> function. The <code>hfun_recentblogposts()</code> function has one extra requirement of <code>rss_description</code>. An example is shown below.</li>
</ol>
<pre class="text"><code>+++
title = "Setting Up a Franklin.jl Blog"
date = Date(2025,11,11)
rss_description = "Setting Up a Franklin.jl Blog"
+++</code></pre>
<p><del>The blog post you are reading now was created from the above instructions.</del></p>



 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2025/11/2025-11-11-getting-Franklin_jl_setup.html</guid>
  <pubDate>Tue, 11 Nov 2025 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Engineering Workstation Build</title>
  <link>https://jasonhnicholson.com/posts/2024/11/2024-11-12-Engineering-Workstation-Build.html</link>
  <description><![CDATA[ 





<section id="purpose" class="level2">
<h2 class="anchored" data-anchor-id="purpose">Purpose</h2>
<p>The main goal of this build is to make a custom engineering workstation that is appropriate for Scientific Computing (MATLAB), CAD (SolidWorks, OnShape, AutoDesk products, etc), FEA (Code_Aster, Calculix, LISA, etc), CFD (OpenFoam, Code_Saturne, Code_Syrthes), video encoding (AV1, h.265, h.266), and computer vision. It will dual boot Windows and Linux.</p>
<p>The rest of what follows is my design rationale for my choices.</p>
</section>
<section id="notes" class="level2">
<h2 class="anchored" data-anchor-id="notes">Notes</h2>
<p>I am using <a href="https://pcpartpicker.com/">PCPartPicker.com</a> to configure the build, <a href="https://pcpartpicker.com/user/jasonhnicholson/saved/4hH97P">Engineering Build 2025</a>. I am using <a href="https://www.passmark.com/">passmark.com</a> to compare different parts. Part benchmarks can be found linked in the Details from this page, <a href="https://pcpartpicker.com/user/jasonhnicholson/saved/4hH97P">Engineering Build 2025</a>. Below is the part list, what I paid (2025-Feb-01 purchase), and where I bought each part.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Item</th>
<th>Price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CPU</td>
<td><a href="https://pcpartpicker.com/product/mBsV3C/intel-core-ultra-7-265k-39-ghz-20-core-processor-bx80768265k">Intel Core Ultra 7 265K 3.9 GHz 20-Core Processor</a></td>
<td>$372.03 @ Amazon</td>
</tr>
<tr class="even">
<td>CPU Cooler</td>
<td><a href="https://pcpartpicker.com/product/LDqrxr/nzxt-kraken-240-7802-cfm-liquid-cpu-cooler-rl-kn240-b1">NZXT Kraken 240 78.02 CFM Liquid CPU Cooler</a></td>
<td>$139.99 @ Amazon</td>
</tr>
<tr class="odd">
<td>Motherboard</td>
<td><a href="https://pcpartpicker.com/product/BW26Mp/msi-mag-z890-tomahawk-wifi-atx-lga1851-motherboard-mag-z890-tomahawk-wifi">MSI MAG Z890 TOMAHAWK WIFI ATX LGA1851 Motherboard</a></td>
<td>$239.99 @ Amazon</td>
</tr>
<tr class="even">
<td>Memory</td>
<td><a href="https://pcpartpicker.com/product/wFdG3C/corsair-vengeance-96-gb-2-x-48-gb-ddr5-5600-cl40-memory-cmk96gx5m2b5600c40">Corsair Vengeance 96 GB (2 x 48 GB) DDR5-5600 CL40 Memory</a></td>
<td>$249.99 @ Amazon</td>
</tr>
<tr class="odd">
<td>Memory</td>
<td><a href="https://pcpartpicker.com/product/wFdG3C/corsair-vengeance-96-gb-2-x-48-gb-ddr5-5600-cl40-memory-cmk96gx5m2b5600c40">Corsair Vengeance 96 GB (2 x 48 GB) DDR5-5600 CL40 Memory</a></td>
<td>$249.99 @ Amazon</td>
</tr>
<tr class="even">
<td>Storage</td>
<td><a href="https://pcpartpicker.com/product/9xsV3C/crucial-t700-wheatsink-1-tb-m2-2280-pcie-50-x4-nvme-solid-state-drive-ct1000t700ssd5">Crucial T700 W/Heatsink 1 TB M.2-2280 PCIe 5.0 X4 NVME Solid State Drive</a></td>
<td>$162.99 @ Amazon</td>
</tr>
<tr class="odd">
<td>Storage</td>
<td><a href="https://pcpartpicker.com/product/9xsV3C/crucial-t700-wheatsink-1-tb-m2-2280-pcie-50-x4-nvme-solid-state-drive-ct1000t700ssd5">Crucial T700 W/Heatsink 1 TB M.2-2280 PCIe 5.0 X4 NVME Solid State Drive</a></td>
<td>$162.99 @ Amazon</td>
</tr>
<tr class="even">
<td>Video Card</td>
<td><a href="https://pcpartpicker.com/product/k866Mp/pny-vcqrtx4000-pb-quadro-rtx-4000-8-gb-video-card-vcqrtx4000-pb">PNY VCQRTX4000-PB Quadro RTX 4000 8 GB Video Card</a></td>
<td>$384.99 @ Amazon</td>
</tr>
<tr class="odd">
<td>Case</td>
<td><a href="https://pcpartpicker.com/product/7ZBG3C/nzxt-h9-flow-atx-mid-tower-case-cm-h91fw-01">NZXT H9 Flow (2023) ATX Mid Tower Case</a></td>
<td>$149.99 @ Amazon</td>
</tr>
<tr class="even">
<td>Power Supply</td>
<td><a href="https://pcpartpicker.com/product/fxGhP6/corsair-rm1000e-2023-1000-w-80-gold-certified-fully-modular-atx-power-supply-cp-9020264-na">Corsair RM1000e (2023) 1000 W 80+ Gold Certified Fully Modular ATX Power Supply</a></td>
<td>$179.99 @ Amazon</td>
</tr>
<tr class="odd">
<td></td>
<td><strong>Subtotal</strong></td>
<td><strong>$2291.95</strong></td>
</tr>
<tr class="even">
<td></td>
<td><strong>Taxes</strong></td>
<td><strong>$155.75</strong></td>
</tr>
<tr class="odd">
<td></td>
<td><strong>Total</strong></td>
<td><strong>$2447.70</strong></td>
</tr>
</tbody>
</table>
<p><br></p>
<p>I benchmarked my 2015 workstation and my linux laptop. Here are the results:</p>
<figure class="figure">
<a href="https://www.passmark.com/baselines/V11/display.php?id=224311404344"><img src="https://www.passmark.com/baselines/V10/images/224311404344.png" alt="PassMark Rating" border="0" class="figure-img"></a>
<figcaption>
2015 Workstation
</figcaption>
</figure>
<figure class="figure">
<a href="https://www.passmark.com/baselines/V11/display.php?id=507820731417"><img src="https://www.passmark.com/baselines/V10/images/507820731417.png" alt="PassMark Rating" border="0" class="figure-img"></a>
<figcaption>
Linux laptop
</figcaption>
</figure>
<p>Both computers are outdated compared to what is available.</p>
</section>
<section id="cpu" class="level2">
<h2 class="anchored" data-anchor-id="cpu">CPU</h2>
<p><a href="https://www.cpubenchmark.net/cpu_value_available.html#xy_scatter_graph">Single CPU XY Scatter Graph</a> and <a href="https://www.cpubenchmark.net/cpu_value_available.html#thread_xy_scatter_graph">Single Thread XY Scatter Graph</a> to identify processor that balance price and speed. The graphs are shown below for convenience.</p>
<p><img src="https://jasonhnicholson.com/posts/2024/11/single-cpu-xy-scatter-graph.png" class="img-fluid" alt="Single CPU XY Scatter Graph"> <img src="https://jasonhnicholson.com/posts/2024/11/single-thread-xy-scatter-graph.png" class="img-fluid" alt="Single Thread XY Scatter Graph"></p>
</section>
<section id="benchmark-update" class="level2">
<h2 class="anchored" data-anchor-id="benchmark-update">2025-12-06 Benchmark Update</h2>
<p>After setup, I ran PassMark PerformanceTest 11 to benchmark the system.</p>
<figure class="figure">
<a href="https://www.passmark.com/baselines/V11/display.php?id=510883741617"><img src="https://www.passmark.com/baselines/V10/images/510883741617.png" alt="PassMark Rating" border="0" class="figure-img"></a>
<figcaption>
2025 Workstation Benchmark Results
</figcaption>
</figure>
<p>The new workstation is 30x faster than the 2015 workstation and 6x faster than my linux laptop.</p>


</section>

 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2024/11/2024-11-12-Engineering-Workstation-Build.html</guid>
  <pubDate>Tue, 12 Nov 2024 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Trust-Region-Dogleg and Newton-Raphson - A Quick Comparison on a 5th order polynomial</title>
  <link>https://jasonhnicholson.com/posts/2021/10/2021-10-24-trust-region-dogleg-and-newton-raphson-a-quick-story.html</link>
  <description><![CDATA[ 





<p>A Newton-Raphson iteration produces a fractal pattern in the complex plane and a Trust-Region-Dogleg method produces a smoother pattern in the complex which is desirable for a nonlinear equation solver. The context of this statement is finding the roots of a polynomial in a complex plan from different starting points. The inspiration for this post was the video from <a href="https://www.youtube.com/watch?v=-RdOwhmqP5s&amp;feature=youtu.be">3Blue1Brown, Newton’s Fractal (which Newton knew nothing about)</a>.</p>
<p>Given the polynomial</p>
<p><img src="https://latex.codecogs.com/png.latex?P(z)%20=%20z%5E5%20+%20z%5E2%20-%20z%20+%201%20=%200"></p>
<p>find a root starting from anywhere in the interval of -2 to 2 and -2i to 2i.</p>
<p><strong>Common code:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb1-1"> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clear</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">close</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">all</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% setup polynomial function</span></span>
<span id="cb1-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">coefficients</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">polynomialFunction</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span>) <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">polyval</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">coefficients</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% setup the derivative of the polynomial function</span></span>
<span id="cb1-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">coefficients_dot</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">polyder</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">coefficients</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">polynomialDerivativeFunction</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span>) <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">polyval</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">coefficients_dot</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% roots of the polynomial. roots uses a eigenvalues of a companion matrix approach.</span></span>
<span id="cb1-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% rootsOfPolynomial = roots(coefficients);</span></span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% exact roots</span></span>
<span id="cb1-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootsOfPolynomial</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1i</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-15"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootsOfPolynomial</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1i</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-16"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootsOfPolynomial</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1i</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">69</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">69</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">69</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1i</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-17"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootsOfPolynomial</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>  (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1i</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">69</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">69</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">69</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1i</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-18"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootsOfPolynomial</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>((<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">69</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">69</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Calculate a grid of starting points using the ndgrid format. x (real part)</span></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% follow rows (1st dimension) and y follows the columns (2nd dimension).</span></span>
<span id="cb1-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% ndgrid is format is transpose of meshgrid format. meshgrid format is used</span></span>
<span id="cb1-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% for plotting surfaces.</span></span>
<span id="cb1-24"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">nStartingPointReal</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">nStartingPointImaginary</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">401</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-26"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">startingPointReal</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">linspace</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">nStartingPointReal</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">';</span></span>
<span id="cb1-27"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">startingPointImaginary</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">linspace</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eps</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">nStartingPointImaginary</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1i</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-28"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">startingPoint</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">startingPointReal</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">startingPointImaginary</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% using singleton expansion</span></span>
<span id="cb1-29"></span>
<span id="cb1-30"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">maxIterations</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-31"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">functionTolerance</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-14</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-32"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">divideByZeroTolerance</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% 1000*eps(p)</span></span></code></pre></div></div>
<section id="newton-raphson-iteration" class="level2">
<h2 class="anchored" data-anchor-id="newton-raphson-iteration">Newton-Raphson Iteration</h2>
<p>Using Newton’s method starting anywhere in the interval -2 to 2 and -2i to 2i produces the following pattern.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% setup for iteration</span></span>
<span id="cb2-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isConverged</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">false</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">nStartingPointReal</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">nStartingPointImaginary</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isDivideByZero</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">false</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">nStartingPointReal</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">nStartingPointImaginary</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">whileFlag</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">true</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">iteration</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">startingPoint</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% check if the starting value was already converged.</span></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% polynomial is less then functionTolerance.</span></span>
<span id="cb2-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">polynomialFunction</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isConverged</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isConverged</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isConverged</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">abs</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">functionTolerance</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-13"></span>
<span id="cb2-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% begin iteration</span></span>
<span id="cb2-15"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">polynomialFunction</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isConverged</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-16"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">whileFlag</span></span>
<span id="cb2-17">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% increment iteration number</span></span>
<span id="cb2-18">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">iteration</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">iteration</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-19">    </span>
<span id="cb2-20">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">polynomialFunction</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isConverged</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-21">    </span>
<span id="cb2-22">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Calculate the derivative of the polynomial.</span></span>
<span id="cb2-23">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Check for divide by 0. If p_dot is close to machine precision</span></span>
<span id="cb2-24">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% of p, then its a divide by 0 error. </span></span>
<span id="cb2-25">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Stop all further iteration.</span></span>
<span id="cb2-26">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p_dot</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">polynomialDerivativeFunction</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isConverged</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-27">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isDivideByZeroIteration</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">abs</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p_dot</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">divideByZeroTolerance</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eps</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">abs</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-28">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isDivideByZero</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isConverged</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isDivideByZeroIteration</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-29">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isConverged</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isConverged</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isDivideByZeroIteration</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-30">    </span>
<span id="cb2-31">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% calculate Newton iteration on unconverged points.</span></span>
<span id="cb2-32">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isConverged</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isConverged</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isDivideByZeroIteration</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">./</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p_dot</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isDivideByZeroIteration</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-33">    </span>
<span id="cb2-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% check for convergence</span></span>
<span id="cb2-35">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">polynomialFunction</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isConverged</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-36">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isConverged</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isConverged</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">abs</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">functionTolerance</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-37">    </span>
<span id="cb2-38">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% set while flag</span></span>
<span id="cb2-39">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% all roots have converged or reached max iterations</span></span>
<span id="cb2-40">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">whileFlag</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">iteration</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">maxIterations</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">all</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">all</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isConverged</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-41"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">end</span></span>
<span id="cb2-42"></span>
<span id="cb2-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% successful roots</span></span>
<span id="cb2-44"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isRoot</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isConverged</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isDivideByZero</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-45"></span>
<span id="cb2-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% which root did newton's method converge too?</span></span>
<span id="cb2-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% calculate the difference between the converged root and the roots of the polynomial</span></span>
<span id="cb2-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% the smallest distance corresponds to the root index</span></span>
<span id="cb2-49"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zDiff</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">abs</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reshape</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootsOfPolynomial</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>[]))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% using singelton expansion</span></span>
<span id="cb2-50">[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootErrors</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootIndex</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">min</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zDiff</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>[]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% minimum along 3rd dimension</span></span>
<span id="cb2-51"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootIndex</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isRoot</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-52"></span>
<span id="cb2-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% create the fractal image</span></span>
<span id="cb2-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% imagesc uses the meshgrid format where </span></span>
<span id="cb2-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% x is the 2nd dimension </span></span>
<span id="cb2-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% y is the first dimension</span></span>
<span id="cb2-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% therefore, transpose rootIndex because its in the ndgrid format</span></span>
<span id="cb2-58"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">figure</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-59"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">imagesc</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">startingPointReal</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">',</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">imag</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">startingPointImaginary</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootIndex</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb2-60"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">c</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">prism</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">numel</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootsOfPolynomial</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-61"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">colormap</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">c</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-62"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xlabel</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Real Axis"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylabel</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Imaginary Axis"</span>)</span>
<span id="cb2-63"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylabel</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">colorbar</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Ticks'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">numel</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootsOfPolynomial</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Root Index"</span>)</span>
<span id="cb2-64"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hold</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">all</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb2-65"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootsOfPolynomial</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'ko'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'MarkerSize'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'LineWidth'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb2-66"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">title</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Newton-Raphson Convergence for z^5+z^2-z+1"</span>)</span></code></pre></div></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jasonhnicholson.com/posts/2021/10/image-1.png" class="img-fluid figure-img"></p>
<figcaption>Red is unconverged. The other colors correspond to a root. The o’s are the roots.</figcaption>
</figure>
</div>
</section>
<section id="trust-region-dogleg-iteration" class="level2">
<h2 class="anchored" data-anchor-id="trust-region-dogleg-iteration">Trust-Region-Dogleg Iteration</h2>
<p>The MATLAB fsolve() function uses the Trust-Region-Dogleg method to find a root of a nonlinear equation. What’s interesting is how much smoother the boundaries are for the Trust-Region-Dogleg method.</p>
<p>More information on Trust-Region-Dogleg method<br>
- <a href="https://en.wikipedia.org/wiki/Powell%27s_dog_leg_method">Powell’s dog leg method - Wikipedia</a><br>
- <a href="https://www.mathworks.com/help/releases/R2020a/optim/ug/equation-solving-algorithms.html#f51887">Trust-Region-Dogleg Algorithm - MathWorks</a></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb3-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">optimoptions</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'fsolve'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Display'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SpecifyObjectiveGradient"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">true</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...</span></span>
<span id="cb3-2">    <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'FunctionTolerance'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">functionTolerance</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'StepTolerance'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootErrors</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isRoot</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,...</span></span>
<span id="cb3-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Algorithm"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"trust-region-dogleg"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% calling fsolve with the first argument as a cell array is undocumented but it works and is easy to setup. In a future</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% version of MATLAB, this may not work because its undocumented. Also, each root is found one at a time and this is </span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% ver inefficient. This could be a lot better but that is not the focus of today.</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% </span></span>
<span id="cb3-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tic</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-9">[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,~,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">exitflag2</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">arrayfun</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z0</span>) <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fsolve</span>({<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">polynomialFunction</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">polynomialDerivativeFunction</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">startingPoint</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">toc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-11"></span>
<span id="cb3-12"></span>
<span id="cb3-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Elapsed</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">time</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">is</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">406.891834</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">seconds</span>.</span>
<span id="cb3-14"></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% successful roots</span></span>
<span id="cb3-16"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isRoot2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">exitflag2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-17"></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% which root did the Trust-Region-Dogleg method converge too?</span></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% calculate the difference between the converged root and the roots of the polynomial</span></span>
<span id="cb3-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% the smallest distance corresponds to the root index</span></span>
<span id="cb3-21"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zDiff2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">abs</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reshape</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootsOfPolynomial</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>[]))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% using singelton expansion</span></span>
<span id="cb3-22">[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootErrors2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootIndex2</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">min</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zDiff2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>[]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% minimum along 3rd dimension</span></span>
<span id="cb3-23"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootIndex2</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">isRoot2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-24"></span>
<span id="cb3-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% create the fractal image</span></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% imagesc uses the meshgrid format where </span></span>
<span id="cb3-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% x is the 2nd dimension </span></span>
<span id="cb3-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% y is the first dimension</span></span>
<span id="cb3-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% therefore, transpose rootIndex2 because its in the ndgrid format</span></span>
<span id="cb3-30"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">figure</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-31"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">imagesc</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">startingPointReal</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">',</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">imag</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">startingPointImaginary</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootIndex2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb3-32"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">colormap</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">c</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-33"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xlabel</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Real Axis"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylabel</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Imaginary Axis"</span>)</span>
<span id="cb3-34"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylabel</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">colorbar</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Ticks'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">numel</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootsOfPolynomial</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Root Index"</span>)</span>
<span id="cb3-35"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hold</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">all</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-36"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rootsOfPolynomial</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'ko'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'MarkerSize'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'LineWidth'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb3-37"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">title</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Trust-Region-Dogleg Convergence for z^5+z^2-z+1"</span>)</span></code></pre></div></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jasonhnicholson.com/posts/2021/10/image-2.png" class="img-fluid figure-img"></p>
<figcaption>Red is unconverged. The other colors correspond to a root. The o’s are the roots.</figcaption>
</figure>
</div>


</section>

 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2021/10/2021-10-24-trust-region-dogleg-and-newton-raphson-a-quick-story.html</guid>
  <pubDate>Sun, 24 Oct 2021 04:00:00 GMT</pubDate>
</item>
<item>
  <title>Neural Networks. Controls, and System Identification</title>
  <link>https://jasonhnicholson.com/posts/2021/07/2021-07-19-neural-networks-controls-and-system-identification.html</link>
  <description><![CDATA[ 





<p>The current engineer atmosphere is buzzing about Neural Networks. The downside is that Neural Networks do not have a structure that is easily understandable and interpretable. When we can understand the physic mechanisms, Neural Networks should not be your first choice, in my opinion.</p>
<p>The links below take you directly to the start of the pertinent question(s). Among the two controls authors, they agree we can do the same or better than Neural Networks. Gene Morelli is from NASA. Stephen Boyd is from Stanford.</p>
<p><a href="https://youtu.be/78KzrXE-Ng8?t=4783">Gene Morelli from NASA responds about Neural Networks</a>. The video jumps to the start of this question at 1:19:43, and the question is finished at 1:21:30. The total question time is 1:47.</p>
<p><a href="https://youtu.be/U41e7hKAAPQ?t=6048">Stephen Boyd Response to Neural Network Use in Optimization and Control</a> Question starts at 1:40:48. It gets interesting at 1:43:15. The question concludes at 1:44:47. The total question time is 3:59.</p>
<p>The counterpoint to my viewpoint is Chris Rackauckas’s <a href="https://www.youtube.com/watch?v=AKwqJxhKkoA">Automated Discovery of Mechanistic Models via Universal Differential Equations</a>. Sometime in the future, Neural Networks may dominate. For now, I don’t see it this way and think controls engineers should use other methods if they can understand their system.</p>



 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2021/07/2021-07-19-neural-networks-controls-and-system-identification.html</guid>
  <pubDate>Mon, 19 Jul 2021 04:00:00 GMT</pubDate>
</item>
<item>
  <title>System Identification Resources</title>
  <link>https://jasonhnicholson.com/posts/2021/07/2021-07-19-system-identification-resources.html</link>
  <description><![CDATA[ 





<p>This blog post was turned into a page here: <a href="../../../pages/system-identification">System Identification Resources</a></p>



 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2021/07/2021-07-19-system-identification-resources.html</guid>
  <pubDate>Mon, 19 Jul 2021 04:00:00 GMT</pubDate>
</item>
<item>
  <title>Linux HTML Documentation Index</title>
  <link>https://jasonhnicholson.com/posts/2021/05/2021-05-09-linux-html-documentation-index.html</link>
  <description><![CDATA[ 





<p>On Ubuntu Linux, there is a package called “dhelp”. dhelp allows viewing the man and info pages through a web browser. I find this very useful. man2html and info2www are required for dhelp. dhelp may work on other Linux systems but I cannot confirm this.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> apt install dhelp man2html info2www</span></code></pre></div></div>
<p>dhelp package description:</p>
<blockquote class="blockquote">
<p>Read all documentation with a WWW browser. dhelp builds an index of all installed HTML documentation. You don’t need a WWW server to read the documentation. dhelp offers a very fast search in the HTML documents.</p>
<p>You can access the online help system with the dhelp program or with your browser. The URL to point your browser at is (if you have a WWW server installed) http://localhost/doc/HTML/index.html , else (if you do not) file://localhost/usr/share/doc/HTML/index.html.</p>
</blockquote>



 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2021/05/2021-05-09-linux-html-documentation-index.html</guid>
  <pubDate>Sun, 09 May 2021 04:00:00 GMT</pubDate>
</item>
<item>
  <title>Nonlinear Equation System Solving Using Newton, Line Search, and LU factorization</title>
  <link>https://jasonhnicholson.com/posts/2021/04/2021-04-12-nonlinear-equation-system-solving-using-newton-line-search-and-lu-factorization.html</link>
  <description><![CDATA[ 





<section id="summary" class="level1">
<h1>Summary</h1>
<p>A couple of weeks ago, I was inspired to revisit Newton’s method for solving nonlinear equations. I was reminded of my undergrad days when I read a paper by Madsen and Reid about finding the roots of a polynomial. What struck me at that time is Madsen-Reid’s application of Newton’s method with a line search was faster than any other algorithm. The Madsen-Reid papers were written in 1973 and 1975. Ever since then, when another paper benchmarked various algorithms to find roots of polynomials, Madsen-Reid would win; to my knowledge, if root-finding of polynomials is benchmarked in literature and the Fortran Madsen-Reid algorithm (PA16 and/or PA17) is used, the Madsen-Reid algorithm is the fastest and nearly the most accurate. What made the algorithm so successful? How can this generalize to solving a set of nonlinear equations? In this post, I plan to discuss these ideas.</p>
<p>Note that I have a little math syntax but not as much as you would find in a math article or paper. This means my language is a little more inexact and high level without explaining all the detail.</p>
</section>
<section id="the-madsen-reid-algorithm" class="level1">
<h1>The Madsen-Reid Algorithm</h1>
<p>The Madsen-Reid algorithm can be summarized as follows:</p>
<ol type="1">
<li>Calculate a newton direction <img src="https://latex.codecogs.com/png.latex?d%20=%20-%20%7Bf'%7D%5E%7B-%201%7Df">. Do a line search along the <img src="https://latex.codecogs.com/png.latex?d"> direction to find where <img src="https://latex.codecogs.com/png.latex?%7Cf%7C"> is the smallest. However, don’t find the minimum perfectly. Instead, quit after <img src="https://latex.codecogs.com/png.latex?%7Cf%7C"> isn’t decreasing in a sequence of new guesses along <img src="https://latex.codecogs.com/png.latex?d">. This is called “stage 1.”</li>
<li>Switch to pure newton iteration based on checking an inequality that ensures convergence. This is called “stage 2” pure Newton iteration. If the inequality fails, go back to stage 1.</li>
</ol>
<p>The beauty of the Madsen-Reid algorithm is that it is</p>
<ul>
<li>Fast</li>
<li>Simple</li>
<li>Guaranteed quadratic convergence even to roots with multiplicities greater than 1 because of stage 1 line search. Guaranteed quadratic convergence is rare.</li>
</ul>
<p>Link to a paper describing the Madsen-Reid algorithm: <a href="https://apps.dtic.mil/sti/pdfs/ADA278422.pdf" class="uri">https://apps.dtic.mil/sti/pdfs/ADA278422.pdf</a></p>
<p>C++ implementation of Madsen-Reid algorithm: <a href="http://www.hvks.com/Numerical/ports.html" class="uri">http://www.hvks.com/Numerical/ports.html</a></p>
<p>Fortran code PA16 and PA17 can be found at <a href="https://www.hsl.rl.ac.uk/catalogue/" class="uri">https://www.hsl.rl.ac.uk/catalogue/</a></p>
</section>
<section id="nonlinear-equation-systems-convex-optimization" class="level1">
<h1>Nonlinear Equation Systems, Convex Optimization</h1>
<p>Newton iteration with a line search has shown up a lot since Madsen-Reid in optimization and root finding of nonlinear equation systems. It isn’t necessarily because of Madsen-Reid that Newton’s method with line search is broadly used. The reason, in my opinion, is different researchers or practitioners have found that Newton’s method with line search is highly effective.</p>
<p>The parallels between Newton iteration with line search in optimization and nonlinear equation solving are:</p>
<style>
#opt-vs-nleq-table tr.odd  { background-color: #fafafa; }
#opt-vs-nleq-table tr.even { background-color: #ffffff; }
#opt-vs-nleq-table thead th { background-color: #f2f2f2; font-weight: 600; }
#opt-vs-nleq-table th, #opt-vs-nleq-table td { padding: 0.5rem 0.75rem; }
</style>
<div id="opt-vs-nleq-table">
<table class="table">
<colgroup>
<col style="width: 50%;border: solid;border-width: thin;">
<col style="width: 49%;border: solid;border-width: thin;">
</colgroup>
<thead>
<tr class="header">
<th>
Unconstrained convex optimization (minimization)
</th>
<th>
Nonlinear equation system
</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>
<p>
<img src="https://latex.codecogs.com/png.latex?Cost%E2%80%84=%E2%80%84F(x)">
</p>
<p>
Where
</p>
<ul>
<li>
<p>
<img src="https://latex.codecogs.com/png.latex?x"> is a vector value function.
</p>
</li>
<li>
<p>
<img src="https://latex.codecogs.com/png.latex?F"> is a scalar function of <img src="https://latex.codecogs.com/png.latex?x">. <img src="https://latex.codecogs.com/png.latex?F"> is at least twice differentiable or Lipschitz continuous. The point is <img src="https://latex.codecogs.com/png.latex?F"> needs to be twice differentiable in some sense.
</p>
</li>
</ul>
</td>
<td>
<p>
You can think of the cost as
</p>
<p>
<img src="https://latex.codecogs.com/png.latex?Cost=%C2%A0%7C%7CF(x)%7C%7C1">
</p>
<p>
Where
</p>
<ul>
<li>
<p>
<img src="https://latex.codecogs.com/png.latex?%7C%7C%C2%A0%C2%A0%7C%7C1"> is one norm (absolute value of the elements of the vector summed).
</p>
</li>
<li>
<p>
However, this isn’t necessary. The above equation helps make the analog to optimization only.
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
<p>
The gradient is 0 at minimum
</p>
<p>
<img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20F%7D%7B%5Cpartial%20x%7D%20=%0A0">
</p>
<p>
Where
</p>
<p>
<img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20F%7D%7B%5Cpartial%20x%7D"> is a vector value function of the <img src="https://latex.codecogs.com/png.latex?x"> vector.
</p>
</td>
<td>
<p>
<img src="https://latex.codecogs.com/png.latex?F(x)%E2%80%84=%E2%80%840">
</p>
<p>
Where
</p>
<ul>
<li>
<p>
<img src="https://latex.codecogs.com/png.latex?F(x)"> is a vector value function of vector x.
</p>
</li>
<li>
<p>
<img src="https://latex.codecogs.com/png.latex?F"> must be twice differentiable in some sense, at least locally. More advanced math will use advanced ideas to say what this means.
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
<p>
The Newton iteration with line search is
</p>
<p>
<img src="https://latex.codecogs.com/png.latex?xk%E2%80%85+%E2%80%851%E2%80%84=%E2%80%84xk%E2%80%85+%E2%80%85%CE%B1D">
</p>
<p>
<img src="https://latex.codecogs.com/png.latex?D%20=%20%5Cleft(%20%5Cfrac%7B%5Cpartial%5E%7B2%7DF%7D%7B%5Cpartial%0Ax%5E%7B2%7D%7D%20%5Cright)%5E%7B-%201%7D%5Cleft(%20-%20%5Cfrac%7B%5Cpartial%20F%7D%7B%5Cpartial%20x%7D%0A%5Cright)">
</p>
<p>
where
</p>
<ul>
<li>
<p>
<img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%5E%7B2%7DF%7D%7B%5Cpartial%20x%5E%7B2%7D%7D"> is the Hessian matrix. If <img src="https://latex.codecogs.com/png.latex?F"> was twice differentiable, then <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%5E%7B2%7DF%7D%7B%5Cpartial%20x%5E%7B2%7D%7D%5C)%20is%20always%20symmetric.%20It%20should%20not%20be%20singular%20if%20you%20are%20going%20to%20invert%20it"></p>
</li>
<li>
<p>
<img src="https://latex.codecogs.com/png.latex?D"> is the direction of the line search.
</p>
</li>
<li>
<p>
<img src="https://latex.codecogs.com/png.latex?%CE%B1"> is the size of the step found via a line search along <img src="https://latex.codecogs.com/png.latex?D">. There are many inexact and exact ways to do the line search. Quadratic approximation, Inexact Line Search, etc. The point is to find an <img src="https://latex.codecogs.com/png.latex?%CE%B1"> that decreases <img src="https://latex.codecogs.com/png.latex?F">.<br> See <a href="https://youtu.be/MKmIvtq83LY">https://youtu.be/MKmIvtq83LY</a> for Quadratic Approximation.<br> See <a href="https://youtu.be/MzmqM0tuO1Q">https://youtu.be/MzmqM0tuO1Q</a> for an inexact line search.
</p>
</li>
</ul>
</td>
<td>
<p>
The Newton iteration with line search is
</p>
<p>
<img src="https://latex.codecogs.com/png.latex?xk%E2%80%85+%E2%80%851%E2%80%84=%E2%80%84xk%E2%80%85+%E2%80%85%CE%B1D">
</p>
<p>
<img src="https://latex.codecogs.com/png.latex?D%20=%20%5Cleft(%20%5Cfrac%7B%5Cpartial%5C%20F%7D%7B%5Cpartial%0Ax%7D%20%5Cright)%5E%7B-%201%7D(%20-%20F)">
</p>
<p>
Where
</p>
<ul>
<li>
<p>
<img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%5C%20F%7D%7B%5Cpartial%20x%7D"> is the Jacobian matrix. It is not symmetric like in optimization. It can’t be singular if you are going to invert it.
</p>
</li>
<li>
<p>
<img src="https://latex.codecogs.com/png.latex?D"> is the direction of the line search.
</p>
</li>
<li>
<p>
<img src="https://latex.codecogs.com/png.latex?%CE%B1"> is the size of the step found via a line search along <img src="https://latex.codecogs.com/png.latex?D">. There are many inexact and exact ways to do the line search. Quadratic approximation, Inexact Line Search, etc. The point is to find an <img src="https://latex.codecogs.com/png.latex?%CE%B1"> that decreases the one norm of <img src="https://latex.codecogs.com/png.latex?F">, <img src="https://latex.codecogs.com/png.latex?%7C%7CF(xk+%CE%B1D)%7C%7C1">.<br> See <a href="https://youtu.be/MKmIvtq83LY">https://youtu.be/MKmIvtq83LY</a> for Quadratic Approximation.<br> See <a href="https://youtu.be/MzmqM0tuO1Q">https://youtu.be/MzmqM0tuO1Q</a> for an inexact line search.
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
<p>
The guarantee of convergence of the newton iteration with line search is
</p>
<ul>
<li>
<p>
<img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%5E%7B2%7DF%7D%7B%5Cpartial%0Ax%5E%7B2%7D%7D"> is positive definite. Said another way, <img src="https://latex.codecogs.com/png.latex?F"> is convex (looks like a parabola).
</p>
</li>
<li>
<p>
If it is not positive definite, then we need to find a replacement direction to search. That direction can come up in many ways but boils down to a change in the direction moving away from a saddle point. See:<br> <a href="https://youtu.be/x1wMciVA6Xc?t=180">https://youtu.be/x1wMciVA6Xc?t=180</a>
</p>
</li>
</ul>
</td>
<td>
I am not sure what the guarantee of convergence is for Newton iteration in the nonlinear system case. As far as I know, <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%5C%20F%7D%7B%5Cpartial%20x%7D"> needs to be invertible, thus nonsingular. I think that is the only requirement. However, we would like to find a way for it to still work if <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%5C%20F%7D%7B%5Cpartial%20x%7D"> is sometimes singular. This what we want to explore in the below sections.
</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="lu-factorization-musings-related-to-newton-iteration" class="level1">
<h1>LU factorization musings related to newton iteration</h1>
<p>When solving for the direction, <img src="https://latex.codecogs.com/png.latex?D">,</p>
<p><img src="https://latex.codecogs.com/png.latex?J%20=%20%5Cfrac%7B%5Cpartial%20F%7D%7B%5Cpartial%20x%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?JD%20=%20-%20F"></p>
<p>The <img src="https://latex.codecogs.com/png.latex?LU"> factorization with partial pivoting of <img src="https://latex.codecogs.com/png.latex?J"> is the best approach to solve this linear system of equations. In MATLAB, <img src="https://latex.codecogs.com/png.latex?D%20=%20J%5Cbackslash%20-%20F"> does the <img src="https://latex.codecogs.com/png.latex?LU"> factorization with partial pivoting underneath the hood similar to this:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb1-1">[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">L</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">U</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lu</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">J</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'vector'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>  </span>
<span id="cb1-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">L</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,:</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>  </span>
<span id="cb1-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">D</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">U</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div></div>
<p>If instead of using a backslash, we do the <img src="https://latex.codecogs.com/png.latex?LU"> factorization with partial pivoting ourselves, we can discover when the Jacobian is ill-conditioned by looking at the diagonal of the upper triangular matrix <img src="https://latex.codecogs.com/png.latex?U">. Let’s look at this in an example before going further.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% this will produce an ill-conditioned A. It has rank of 2.</span></span>
<span id="cb2-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">A</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gallery</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'chebspec'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb2-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">A</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span></span>
<span id="cb2-4">          <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>           <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>          <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb2-5">          <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>            <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>         <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb2-6">         <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>            <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>         <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb2-7"></span>
<span id="cb2-8">[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">L</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">U</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">P</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lu</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">A</span>)</span>
<span id="cb2-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">L</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span></span>
<span id="cb2-10">            <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>            <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>            <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb2-11">     <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.33333</span>            <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>            <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb2-12">      <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.33333</span>          <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>            <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">U</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span></span>
<span id="cb2-14">          <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>           <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>          <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb2-15">            <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>       <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3333</span>      <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3333</span></span>
<span id="cb2-16">            <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>            <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1102e-16</span></span>
<span id="cb2-17"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">P</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span></span>
<span id="cb2-18">     <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>     <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>     <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb2-19">     <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>     <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>     <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-20">     <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>     <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>     <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span></code></pre></div></div>
<p>The U(3,3) is very small. It is close to 0, which implies that <img src="https://latex.codecogs.com/png.latex?A"> is singular within double floating-point precision. U(3,3) very small leads me to my point: <em>Can we use this?</em> Can we eliminate columns and rows from the Jacobian holding constant the value of corresponding value in <img src="https://latex.codecogs.com/png.latex?x"> at the current iteration to find a valid search direction?</p>
<p>Let’s explore this. We need a toy problem to work with. Here is one:</p>
<p><img src="https://latex.codecogs.com/png.latex?F(x)%20=%20%5Cbegin%7Bbmatrix%7D%0Ax_%7B1%7D%5E%7B3%7D%5Carctan%5Cleft(%20x_%7B2%7D%20%5Cright)%20-%202%20%5C%5C%0Ax_%7B1%7D%20+%20x_%7B2%7D%5E%7B2%7D%20-%205%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?x%20=%20%5Cbegin%7Bbmatrix%7D%0Ax_%7B1%7D%20%5C%5C%0Ax_%7B2%7D%0A%5Cend%7Bbmatrix%7D"></p>
<p>The Jacobian is then:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cpartial%20F%7D%7B%5Cpartial%20x%7D%20=%20J%20=%20%5Cbegin%7Bbmatrix%7D%0A3x_%7B1%7D%5E%7B2%7D%5Carctan%5Cleft(%20x_%7B2%7D%20%5Cright)%20&amp;%20%5Cfrac%7Bx_%7B1%7D%5E%7B3%7D%7D%7Bx_%7B2%7D%5E%7B2%7D%5C%20%20+%20%5C%201%7D%20%5C%5C%0A1%20&amp;%202x_%7B2%7D%0A%5Cend%7Bbmatrix%7D"></p>
<p>This <img src="https://latex.codecogs.com/png.latex?F"> was chosen so there was a saddle point at <img src="https://latex.codecogs.com/png.latex?x_%7B1%7D%20=%200"> and <img src="https://latex.codecogs.com/png.latex?x_%7B2%7D%20=%200">. Note that this <img src="https://latex.codecogs.com/png.latex?F"> has other problems, such as horizontal asymptotes in arctan that cause the newton iteration to have problems. This is on purpose, and the line search should take care of problems created by arctan.</p>
<p>There are several cases to analyze:</p>
<ol type="1">
<li><p>What do we do if we started from or land on <img src="https://latex.codecogs.com/png.latex?x%5C%20%20=%20%5C%20%5Clbrack%200,0%5Crbrack%5E%7BT%7D">?</p></li>
<li><p>We start or land on <img src="https://latex.codecogs.com/png.latex?x%20=%20%5Cleft%5Clbrack%200,x_%7B2%7D%20%5Cneq%200%20%5Cright%5Crbrack%5E%7BT%7D">.</p></li>
<li><p>We are close to <img src="https://latex.codecogs.com/png.latex?x%20=%20%5Cleft%5Clbrack%20%5Cepsilon,x_%7B2%7D%20%5Cright%5Crbrack%5E%7BT%7D"> where <img src="https://latex.codecogs.com/png.latex?%5Cepsilon"> is a small number making the Jacobian ill-conditioned but not singular according to MATLAB.</p></li>
</ol>
<section id="case-1-x-lbrack-00rbrackt" class="level2">
<h2 class="anchored" data-anchor-id="case-1-x-lbrack-00rbrackt">Case 1, <img src="https://latex.codecogs.com/png.latex?x%20=%20%5Clbrack%200,0%5Crbrack%5E%7BT%7D"></h2>
<p><img src="https://latex.codecogs.com/png.latex?F"> and J are</p>
<p><img src="https://latex.codecogs.com/png.latex?F%20=%20%5Cleft%5Clbrack%20%5Cbegin%7Bmatrix%7D%0A-%202%20%5C%5C%0A-%205%0A%5Cend%7Bmatrix%7D%5C%20%20%5Cright%5Crbrack"></p>
<p><img src="https://latex.codecogs.com/png.latex?J%20=%20%5Cbegin%7Bbmatrix%7D%0A0%20&amp;%200%20%5C%5C%0A1%20&amp;%200%0A%5Cend%7Bbmatrix%7D"></p>
<p>If we explicitly write out the equations for <img src="https://latex.codecogs.com/png.latex?D"> we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%7B0*D_%7B1%7D%20+%200*D_%7B2%7D%20=%202%0A%7D%7B1*D_%7B1%7D%20+%200*D_%7B2%7D%20=%205%7D"></p>
<p>The <img src="https://latex.codecogs.com/png.latex?LU"> with partial pivoting is</p>
<p><img src="https://latex.codecogs.com/png.latex?L%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20%5C%5C%0A0%20&amp;%201%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?U%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20%5C%5C%0A0%20&amp;%200%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?P%20=%20%5Cbegin%7Bbmatrix%7D%0A0%20&amp;%201%20%5C%5C%0A1%20&amp;%200%0A%5Cend%7Bbmatrix%7D"></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?U(2,2)"> is 0, the Jacobian is singular. The last column of <img src="https://latex.codecogs.com/png.latex?P"> tells us what equation we can eliminate. In this case, we can eliminate the first equation. I think that the <img src="https://latex.codecogs.com/png.latex?P(1,2)"> implies that the second column can be eliminated; this is more easily seen in explicitly writing out the equations for <img src="https://latex.codecogs.com/png.latex?D"> above. Thus, we have</p>
<p><img src="https://latex.codecogs.com/png.latex?1*D_%7B1%7D%20=%205%0A">and we replace the column that we lost with</p>
<p><img src="https://latex.codecogs.com/png.latex?D_%7B2%7D%20=%200"></p>
<p>We can see what our direction should be is</p>
<p><img src="https://latex.codecogs.com/png.latex?D%20=%20%5Cbegin%7Bbmatrix%7D%0A5%20%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D"></p>
<p>However, we need to work this out from the <img src="https://latex.codecogs.com/png.latex?LU"> factorization so we can use it more generally later. We replace the second column of U with 1 on the diagonal. The new <img src="https://latex.codecogs.com/png.latex?U"> is</p>
<p><img src="https://latex.codecogs.com/png.latex?U%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20%5C%5C%0A0%20&amp;%201%0A%5Cend%7Bbmatrix%7D"></p>
<p>We need to replace the last row of <img src="https://latex.codecogs.com/png.latex?L"> with one on the diagonal. The new <img src="https://latex.codecogs.com/png.latex?L"> is</p>
<p><img src="https://latex.codecogs.com/png.latex?L%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20%5C%5C%0A0%20&amp;%201%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?P"> does not change. However, the second row of <img src="https://latex.codecogs.com/png.latex?PF"> changes to 0. The new <img src="https://latex.codecogs.com/png.latex?P(%20-%20F)"> is</p>
<p><img src="https://latex.codecogs.com/png.latex?P(%20-%20F)%20=%20%5Cbegin%7Bbmatrix%7D%0A5%20%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D"></p>
<p>At this point, we carry out the equations to solve the linear system.</p>
<p><img src="https://latex.codecogs.com/png.latex?y%20=%20L%5E%7B-%201%7DP(%20-%20F)%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20%5C%5C%0A0%20&amp;%201%0A%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%0A5%20%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D%20=%20%5Cbegin%7Bbmatrix%7D%0A5%20%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?D%20=%20U%5E%7B-%201%7Dy%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20%5C%5C%0A0%20&amp;%201%0A%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%0A5%20%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D%20=%20%5Cbegin%7Bbmatrix%7D%0A5%20%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D"></p>
<p>Now we have a direction. The question is, does it take us in a direction that makes any sense? If we look at the line search, we get the graph below. The <img src="https://latex.codecogs.com/png.latex?%5Calpha%20=%201"> seems to be the best choice.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jasonhnicholson.com/posts/2021/04/image1.png" class="img-fluid figure-img"></p>
<figcaption>Graph of line search</figcaption>
</figure>
</div>
<p>The next guess is</p>
<p><img src="https://latex.codecogs.com/png.latex?x_%7Bk%20+%201%7D%20=%20%5Cbegin%7Bbmatrix%7D%0A0%20%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D%20+%201%5Cbegin%7Bbmatrix%7D%0A5%20%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D%20=%20%5Cbegin%7Bbmatrix%7D%0A5%20%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D"></p>
<p>And the corresponding <img src="https://latex.codecogs.com/png.latex?F"> is</p>
<p><img src="https://latex.codecogs.com/png.latex?F_%7Bk%20+%201%7D%20=%20%5Cbegin%7Bbmatrix%7D%0A-%202%20%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D"></p>
<p>The Jacobian is</p>
<p><img src="https://latex.codecogs.com/png.latex?J_%7Bk%20+%201%7D%20=%20%5Cbegin%7Bbmatrix%7D%0A0%20&amp;%20125%20%5C%5C%0A1%20&amp;%200%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?LU"> factorization with partial pivoting is</p>
<p><img src="https://latex.codecogs.com/png.latex?L_%7Bk%20+%201%7D%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20%5C%5C%0A0%20&amp;%201%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?U_%7Bk%20+%201%7D%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20%5C%5C%0A0%20&amp;%20125%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?P_%7Bk%20+%201%7D%20=%20%5Cbegin%7Bbmatrix%7D%0A0%20&amp;%201%20%5C%5C%0A1%20&amp;%200%0A%5Cend%7Bbmatrix%7D"></p>
<p>The diagonals of <img src="https://latex.codecogs.com/png.latex?U"> are not zero, so the Jacobian is not singular.</p>
<p>The initial finding here is we <em>CAN</em> use the <img src="https://latex.codecogs.com/png.latex?LU"> decomposition to find a search direction even when we are on a saddle point. This is good news! More work is needed with a bigger system of equations to see if we can always do this.</p>
</section>
<section id="case-2-x-leftlbrack-0x_2-neq-0-rightrbrackt" class="level2">
<h2 class="anchored" data-anchor-id="case-2-x-leftlbrack-0x_2-neq-0-rightrbrackt">Case 2, <img src="https://latex.codecogs.com/png.latex?x%20=%20%5Cleft%5Clbrack%200,x_%7B2%7D%20%5Cneq%200%20%5Cright%5Crbrack%5E%7BT%7D%5C%20"></h2>
<p><img src="https://latex.codecogs.com/png.latex?F"> and <img src="https://latex.codecogs.com/png.latex?J"> are</p>
<p><img src="https://latex.codecogs.com/png.latex?F%20=%20%5Cleft%5Clbrack%20%5Cbegin%7Bmatrix%7D%0A-%202%20%5C%5C%0A-%20x_%7B2%7D%5E%7B2%7D%20-%205%0A%5Cend%7Bmatrix%7D%5C%20%20%5Cright%5Crbrack"></p>
<p><img src="https://latex.codecogs.com/png.latex?J%20=%20%5Cbegin%7Bbmatrix%7D%0A0%20&amp;%200%20%5C%5C%0A1%20&amp;%202x_%7B2%7D%0A%5Cend%7Bbmatrix%7D"></p>
<p>If we explicitly write out the equations for <img src="https://latex.codecogs.com/png.latex?D"> we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?0*D_%7B1%7D%20+%200*D_%7B2%7D%20=%202"> <img src="https://latex.codecogs.com/png.latex?1*D_%7B1%7D%20+%202x_%7B2%7D*D_%7B2%7D%20=%20x_%7B2%7D%5E%7B2%7D%20+%205"></p>
<p>The <img src="https://latex.codecogs.com/png.latex?LU"> with partial pivoting is</p>
<p><img src="https://latex.codecogs.com/png.latex?L%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20%5C%5C%0A0%20&amp;%201%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?U%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%202x_%7B2%7D%20%5C%5C%0A0%20&amp;%200%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?P%20=%20%5Cbegin%7Bbmatrix%7D%0A0%20&amp;%201%20%5C%5C%0A1%20&amp;%200%0A%5Cend%7Bbmatrix%7D"></p>
<p>At this point, we eliminate the first equation and second column. The new <img src="https://latex.codecogs.com/png.latex?L">, <img src="https://latex.codecogs.com/png.latex?U">, <img src="https://latex.codecogs.com/png.latex?P">, and <img src="https://latex.codecogs.com/png.latex?P(%20-%20F)"> are</p>
<p><img src="https://latex.codecogs.com/png.latex?L%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20%5C%5C%0A0%20&amp;%201%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?U%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20%5C%5C%0A0%20&amp;%201%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?P%20=%20%5Cbegin%7Bbmatrix%7D%0A0%20&amp;%201%20%5C%5C%0A1%20&amp;%200%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?P(%20-%20F)%20=%20%5Cbegin%7Bbmatrix%7D%0Ax_%7B2%7D%5E%7B2%7D%20+%205%20%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D"></p>
<p>At this point, we carry out the equations to solve the linear system.</p>
<p><img src="https://latex.codecogs.com/png.latex?y%20=%20L%5E%7B-%201%7DPF%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20%5C%5C%0A0%20&amp;%201%0A%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%0Ax_%7B2%7D%5E%7B2%7D%20+%205%20%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D%20=%20%5Cbegin%7Bbmatrix%7D%0Ax_%7B2%7D%5E%7B2%7D%20+%205%20%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?D%20=%20U%5E%7B-%201%7Dy%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20%5C%5C%0A0%20&amp;%201%0A%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%0Ax_%7B2%7D%5E%7B2%7D%20+%205%20%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D%20=%20%5Cbegin%7Bbmatrix%7D%0Ax_%7B2%7D%5E%7B2%7D%20+%205%20%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D"></p>
<p>Now we have a direction. The question is, does it take us in a direction that makes any sense? If we look at the line search, we get the graph below. Note, several different views are displayed because of the 3d nature of the graph. The answer is we can always take a direction that makes sense based on the direction found.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jasonhnicholson.com/posts/2021/04/image2.png" class="img-fluid figure-img"></p>
<figcaption>Line search surface (view 1)</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jasonhnicholson.com/posts/2021/04/image3.png" class="img-fluid figure-img"></p>
<figcaption>Line search surface (view 2)</figcaption>
</figure>
</div>
<p>If we plot <img src="https://latex.codecogs.com/png.latex?x_%7B2%7D"> vs.&nbsp;<img src="https://latex.codecogs.com/png.latex?%5Calpha"> we get:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jasonhnicholson.com/posts/2021/04/image4.png" class="img-fluid figure-img"></p>
<figcaption>Plot of <img src="https://latex.codecogs.com/png.latex?x_%7B2%7D"> vs <img src="https://latex.codecogs.com/png.latex?%5Calpha"></figcaption>
</figure>
</div>
<p>If we expand out the graph above for large values of <img src="https://latex.codecogs.com/png.latex?x_%7B2%7D"> we see that <img src="https://latex.codecogs.com/png.latex?%5Calpha"> is heading towards 0 (shown below). In the limit <img src="https://latex.codecogs.com/png.latex?x_%7B2%7D"> goes to infinity, <img src="https://latex.codecogs.com/png.latex?%5Calpha"> will go to 0. This tends to point to situations where the ill-conditioning of finding a new <img src="https://latex.codecogs.com/png.latex?x_%7Bk%20+%201%7D">. When <img src="https://latex.codecogs.com/png.latex?%5Calpha%20D"> is near working precision of <img src="https://latex.codecogs.com/png.latex?x_%7Bk%7D">, then <img src="https://latex.codecogs.com/png.latex?x_%7Bk%20+%201%7D%20=%20x_%7Bk%7D"> to working precision. This would cause the Newton iteration to quit near a saddle point rather than near a solution of the nonlinear system of equations. We may have to detect this case by finding the singularity of the Jacobian from the LU factorization. We will need to search an arbitrary direction to get us off this ill-conditioned point.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jasonhnicholson.com/posts/2021/04/image5.png" class="img-fluid figure-img"></p>
<figcaption><img src="https://latex.codecogs.com/png.latex?x_2"> versus <img src="https://latex.codecogs.com/png.latex?%5Calpha"></figcaption>
</figure>
</div>
<p>With our direction <img src="https://latex.codecogs.com/png.latex?D">, the <img src="https://latex.codecogs.com/png.latex?x_%7Bk%20+%201%5C%20%7D"> is</p>
<p><img src="https://latex.codecogs.com/png.latex?x_%7Bk%20+%201%7D%20=%20%5Cbegin%7Bbmatrix%7D%0A0%20%5C%5C%0Ax_%7B2%7D%0A%5Cend%7Bbmatrix%7D%20+%20%5Calpha%5Cbegin%7Bbmatrix%7D%0Ax_%7B2%7D%5E%7B2%7D%20+%205%20%5C%5C%0A0%0A%5Cend%7Bbmatrix%7D%20=%20%5Cbegin%7Bbmatrix%7D%0A%5Calpha%5Cleft(%20x_%7B2%7D%5E%7B2%7D%20+%205%20%5Cright)%20%5C%5C%0Ax_%7B2%7D%0A%5Cend%7Bbmatrix%7D"></p>
<p>The machine double precision of <img src="https://latex.codecogs.com/png.latex?x_%7B1%7D%20=%200"> is</p>
<p><img src="https://latex.codecogs.com/png.latex?eps(0)%20=%204.9407*10%5E%7B-%20324%7D"></p>
<p>This means that <img src="https://latex.codecogs.com/png.latex?%5Calpha%5Cleft(%20x_%7B2%7D%5E%7B2%7D%20+%205%20%5Cright)"> would have to be near <img src="https://latex.codecogs.com/png.latex?eps(0)"> for us to not find a new point, <img src="https://latex.codecogs.com/png.latex?x_%7Bk%20+%201%7D">. <img src="https://latex.codecogs.com/png.latex?%5Calpha"> can be very small and it will still have an impact in this case. For instance, when <img src="https://latex.codecogs.com/png.latex?%5Calpha%20=%2010%5E%7B-%2016%7D">, <img src="https://latex.codecogs.com/png.latex?x_%7B2%7D%20=%202.236082770647552*10%5E%7B8%7D">, <img src="https://latex.codecogs.com/png.latex?x_%7Bk%20+%201%7D%20=%20%5Clbrack%205.000066157186832,%5C%202.236082770647552*10%5E%7B8%7D%5Crbrack"> which is still better than what we had before. More investigation is still warranted, but I am less concerned after looking at an example.</p>
<p>Similar to case 1, we CAN take a step in a direction that makes sense. We may need to refine this at some point because of floating-point precision. For now, though, floating-point precision is not a problem for this case.</p>
</section>
<section id="case-3-x-leftlbrack-epsilonx_2-rightrbrackt" class="level2">
<h2 class="anchored" data-anchor-id="case-3-x-leftlbrack-epsilonx_2-rightrbrackt">Case 3, <img src="https://latex.codecogs.com/png.latex?x%20=%20%5Cleft%5Clbrack%20%5Cepsilon,x_%7B2%7D%20%5Cright%5Crbrack%5E%7BT%7D"></h2>
<p><img src="https://latex.codecogs.com/png.latex?F"> and <img src="https://latex.codecogs.com/png.latex?J"> are</p>
<p><img src="https://latex.codecogs.com/png.latex?F(x)%20=%20%5Cbegin%7Bbmatrix%7D%0A%5Cepsilon%5E%7B3%7D%5Carctan%5Cleft(%20x_%7B2%7D%20%5Cright)%20-%202%20%5C%5C%0A%5Cepsilon%20+%20x_%7B2%7D%5E%7B2%7D%20-%205%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?J%20=%20%5Cbegin%7Bbmatrix%7D%0A3%5Cepsilon%5E%7B2%7D%5Carctan%5Cleft(%20x_%7B2%7D%20%5Cright)%20&amp;%20%5Cfrac%7B%5Cepsilon%5E%7B3%7D%7D%7Bx_%7B2%7D%5E%7B2%7D%5C%20%20+%20%5C%201%7D%20%5C%5C%0A1%20&amp;%202x_%7B2%7D%0A%5Cend%7Bbmatrix%7D"></p>
<p>If we explicitly write out the equations for <img src="https://latex.codecogs.com/png.latex?D"> we get:</p>
<p><img src="https://latex.codecogs.com/png.latex?%7B3%5Cepsilon%5E%7B2%7D%5Carctan%5Cleft(%20x_%7B2%7D%20%5Cright)*D_%7B1%7D%20+%20%5Cfrac%7B%5Cepsilon%5E%7B3%7D%7D%7Bx_%7B2%7D%5E%7B2%7D%5C%20%20+%20%5C%201%7D*D_%7B2%7D%20=%20-%20%5Cepsilon%5E%7B3%7D%5Carctan%5Cleft(%20x_%7B2%7D%20%5Cright)%20+%202%0A%7D%7B1*D_%7B1%7D%20+%202x_%7B2%7D*D_%7B2%7D%20=%20-%20%5Cepsilon%20+%20x_%7B2%7D%5E%7B2%7D%20+%205%7D"></p>
<p>Through a bit of experiment with <img src="https://latex.codecogs.com/png.latex?x_%7B2%7D%20=%201"> and trying to find when <img src="https://latex.codecogs.com/png.latex?J"> becomes rank 1 according to MATLAB, <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%20=%202*10%5E%7B-%208%7D"> is rank 2 while <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%20=%201*10%5E%7B-%208%7D"> is rank 1.</p>
<p>For the case that <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%20=%202*10%5E%7B-%208%7D"> and <img src="https://latex.codecogs.com/png.latex?x_%7B2%7D%20=%201">, the <img src="https://latex.codecogs.com/png.latex?LU"> factorization yields:</p>
<p><img src="https://latex.codecogs.com/png.latex?L%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20%5C%5C%0A9.42477796076938*10%5E%7B-%2016%7D%20&amp;%201%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?U%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%202%20%5C%5C%0A0%20&amp;%20-%201.88495558815388*10%5E%7B-%2015%7D%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?P%20=%20%5Cbegin%7Bbmatrix%7D%0A0%20&amp;%201%20%5C%5C%0A1%20&amp;%200%0A%5Cend%7Bbmatrix%7D"></p>
<p>If we missed this as a singular case, we would get a direction of</p>
<p><img src="https://latex.codecogs.com/png.latex?y%20=%20L%5E%7B-%201%7DP(%20-%20F)%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%200%20%5C%5C%0A-%209.42477796076938*10%5E%7B-%2016%7D%20&amp;%201%0A%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%0A0%20&amp;%201%20%5C%5C%0A1%20&amp;%200%0A%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%0A-%202%20%5C%5C%0A-%203.999999980000000%0A%5Cend%7Bbmatrix%7D%20=%20%5Cbegin%7Bbmatrix%7D%0A3.99999998%20%5C%5C%0A1.999999999999996%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%7BD%20=%20U%5E%7B-%201%7Dy%20=%20%5Cbegin%7Bbmatrix%7D%0A1%20&amp;%201.061032956197551*10%5E%7B15%7D%20%5C%5C%0A0%20&amp;%20-%205.305164780987754*10%5E%7B14%7D%0A%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%0A3.99999998%20%5C%5C%0A1.999999999999996%0A%5Cend%7Bbmatrix%7D%0A%7D%7B=%20%5Cbegin%7Bbmatrix%7D%0A2.122065912395102*10%5E%7B15%7D%20%5C%5C%0A-%201.061032956197549*10%5E%7B15%7D%0A%5Cend%7Bbmatrix%7D%7D"></p>
<p>This direction is enormous in magnitude. It seems like it could cause problems. However, the line search keeps this from getting worse. For the above <img src="https://latex.codecogs.com/png.latex?D">, <img src="https://latex.codecogs.com/png.latex?%5Calpha%20=%207.82707232360737*10%5E%7B-%2016%7D">. The line search saves the day. This is what makes the Newton iteration with line search so robust. Even with a huge Newton direction, we can take an appropriate step because of the line search.</p>
<p><img src="https://latex.codecogs.com/png.latex?%7Bx_%7Bk%20+%201%7D%20=%20x_%7Bk%7D%20+%20%5Calpha%20D%20=%20%5Cbegin%7Bbmatrix%7D%0A2*10%5E%7B-%208%7D%20%5C%5C%0A1%0A%5Cend%7Bbmatrix%7D%20+%207.82707232360737*10%5E%7B-%2016%7D%5Cbegin%7Bbmatrix%7D%0A2.122065912395102*10%5E%7B15%7D%20%5C%5C%0A-%201.061032956197549*10%5E%7B15%7D%0A%5Cend%7Bbmatrix%7D%0A%7D%7B=%20%5Cbegin%7Bbmatrix%7D%0A1.660956357177832%20%5C%5C%0A0.169521831411085%0A%5Cend%7Bbmatrix%7D%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?F%5Cleft(%20x_%7Bk%20+%201%7D%20%5Cright)%20=%20%5Cbegin%7Bbmatrix%7D%0A-%201.230531207840158%20%5C%5C%0A-%203.310305991497200%0A%5Cend%7Bbmatrix%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cleft%7C%20%5Cleft%7C%20F%5Cleft(%20x_%7Bk%20+%201%7D%20%5Cright)%20%5Cright%7C%20%5Cright%7C_%7B1%7D%20=%204.54083719933736"></p>
<p>While</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cleft%7C%20%5Cleft%7C%20F%5Cleft(%20x_%7Bk%7D%20%5Cright)%20%5Cright%7C%20%5Cright%7C_%7B1%7D%20=%205.999999980000000"></p>
<p>In case 3, we CAN take a step that makes sense. The line search is the star of the show. It prevents us from taking too big of a step.</p>
</section>
</section>
<section id="whats-next" class="level1">
<h1>What’s Next?</h1>
<p>I need to</p>
<ul>
<li><p>Write a MATLAB function for Newton iteration with line search and LU factorization to recognize singularity.</p></li>
<li><p>Implement a line search using a quadratic interpolation to find the step size, <img src="https://latex.codecogs.com/png.latex?%5Calpha">. This will be key. Madsen-Reid’s line search would also work.</p></li>
<li><p>I need to add inequality constraints. This will most likely add some Lagrange multipliers or something similar. This will be needed especially for functions like log where crossing a vertical asymptote is a terrible idea. This will be needed when we want one particular solution and don’t want to cross into the basin of attraction to another solution.</p></li>
<li><p>Write this in Simulink so that it can be compiled to code and even work on fixed-point types.</p>
<ul>
<li>This will require using some custom LU code. See the examples of the Fixed-point types for MATLAB functions.</li>
</ul></li>
</ul>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Newton iteration with a line search with <img src="https://latex.codecogs.com/png.latex?LU"> factorization to find the singular case looks to be a very robust nonlinear equation solver.</p>


</section>

 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2021/04/2021-04-12-nonlinear-equation-system-solving-using-newton-line-search-and-lu-factorization.html</guid>
  <pubDate>Mon, 12 Apr 2021 04:00:00 GMT</pubDate>
</item>
<item>
  <title>SSH, Windows, Web Servers, Linux, and Visual Studio Code</title>
  <link>https://jasonhnicholson.com/posts/2020/12/2020-12-31-ssh-windows-web-servers-linux-and-visual-studio-code.html</link>
  <description><![CDATA[ 





<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The hardest thing about trying to do something new with computers these days is that it is hard to focus on the one new thing I am trying to learn. I want to start working on setting up a web server to implement engineering calculations at openhydrualics.com because I want them to be open and easy for anyone to use. This post is the saga I have been through to get to where I am today, a working web server that I can access to create the website I want.</p>
</section>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>I volunteer on an ISO, International Organization for Standardization, committee writing a new standard for calculating derived displacement for the hydraulics industry. As I have listened to what is going on in the tech world, I have seen things like Alliance for Open Media (AOM). AOM has united businesses in collaboration to develop the next generation of video codecs called AV1. I want to do similar things in the hydraulics industry to save money and time, and move the world forward. It is a great way to impact the world, and it is my part in making the world we live in a better place. Therefore, I thought that building a unified implementation of hydraulic engineering calculations that are open source and delivered via the web is a great way to tie all of this together. This may end up being a non-profit, or it may just be an open-source project. We will see, and I am still exploring this. The real point today is getting the environment set up so that I can develop a web application.</p>
</section>
<section id="the-saga" class="level2">
<h2 class="anchored" data-anchor-id="the-saga">The Saga</h2>
<p>The first thing I had to decide was what programming language and toolset I would use to develop my web app. I know MATLAB really well. I would love to use MATLAB. To quote MATLAB help related to web apps:</p>
<blockquote class="blockquote">
<p>MATLAB web apps are designed to run only within a trusted intranet environment, not in the open Internet. For more information, see&nbsp;<a href="https://www.mathworks.com/help/compiler/webapps/potential-risks.html">Potential Risks</a>.</p>
<p>https://www.mathworks.com/help/compiler/web-apps.html</p>
</blockquote>
<p>So this looked like a nonstarter using MATLAB. Besides, was I going to pay for using MATLAB plus several toolboxes? Maybe. MATLAB is about $2000, with each toolbox costing another $2000. That isn’t too bad if all I had to pay was $4000-5000 plus a few days; this would be time-efficient. However, it isn’t a real option.</p>
<p>I started exploring other web apps such as Google Colab, <a href="https://www.streamlit.io/">Streamlit</a> (Python), <a href="https://genieframework.github.io/Genie.jl/dev/">Genie</a> (Julia), and <a href="https://blockpad.net/">Blockpad</a>. Google Colab isn’t right because it requires sign-in and knowledge to use a Jupyter notebook with Python for my users. Blockpad is interesting but too basic for what I need; i.e., I need linear algebra and scientific computing. The Julia language was built for scientific computing. Genie was built to create web apps and looks good. Streamlit looks really good too. I want to learn Julia more than I want to learn Python because I tend to write scientific computing programs. As I have explored Genie and Julia, I am more sold that it is a good general direction.</p>
<p>Hosting was the next thing to consider. My website, jasonhnicholson.com, is hosted on <a href="https://www.bluehost.com/">Bluehost</a> shared hosting. I learned that shared hosting is extremely locked down. I cannot use Julia or Python on the shared hosting platform in flexible enough ways. I had to compile python from scratch, which would have been fine if it worked, but it didn’t. It failed to compile correctly, which left me with a broken Python. I also tried Julia but received errors related to shared libraries (shown below), which told me that compiling was just a waste of time. I spent a whole weekend trying to solve the “Is shared hosting a good solution” question. I think shared hosting is not a good solution for running Julia or Python for my expertise level. It costs too much time.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">user1@jasonhnicholson.com</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">~</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span># julia</span>
<span id="cb1-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">julia:</span> error while loading shared libraries: libjulia.so.1: cannot open shared object file: No such file or directory</span>
<span id="cb1-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">user1@jasonhnicholson.com</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">~</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>#</span></code></pre></div></div>
<p>Next up was I tried Virtual Private Server (VPS) for Bluehost, a step up compared to shared hosting. It gave access to a CentOS server with a package manager for around $30 a month; it could be cheaper, but I am paying monthly, so I don’t get it cheaper for a yearly subscription. Other services are cheaper, but I have used Bluehost for a while. Time is worth more than learning another hosting platform. Long term, I may do something different.</p>
<p>VPS was easier to work with than shared hosting. The downside was that it took a whole four days to get things working correctly between SSH, CPanel, WHM, Julia, yum, rpm, CentOS, Julia, bash, and more. If some of these things are not familiar to you, it should explain the vast difficulty of trying to work cross-disciplinary on the web. It isn’t easy. I am comfortable enough with Linux that bash doesn’t scare me. I google things just like everyone else. I can learn but be more focused when I can help it.</p>
<p>The Cpanel is a web hosting control panel. WHM is a Web Host Manager. Together Cpanel and WHM work to provide a web interface to my Bluehost VPS server. These were failing on the first setup to Bluehost. I ran into an infinite refresh of the Cpanel page. I started the VPS setup on a Friday. Six calls to Bluehost, and four days later, I had a working VPS server on Tuesday morning. My time is limited when I work on projects like this. I have maybe a few hours a weekend and nights. Having patience is important but a difficult discipline. Here was another lesson in patience and flexibility. I learned. I grew.</p>
<p>Next was SSH. SSH keys and SSH on windows don’t play well together. This where I have to understand Linux file permissions, SSH file requirements, Windows file permissions, and the different implementations of SSH across Linux and Windows. It’s a mess. The short story is to find the <a href="https://github.com/PowerShell/Win32-OpenSSH/wiki/Install-Win32-OpenSSH">Microsoft OpenSSH repository</a>. Putty works. Mosh works and is unusable. Git Bash works and is usable. However, I had to face the SSH file permissions concerning SSH keys on windows at some point. Microsoft has written Powershell scripts to deal with SSH key file permissions in the repo documentation: <a href="https://github.com/PowerShell/Win32-OpenSSH/wiki/OpenSSH-utility-scripts-to-fix-file-permissions">OpenSSH utility scripts fix file permissions</a>. When I find the right information, it is amazing how simple this is to solve. When you don’t understand the problem and can’t find the right information, it is amazing the amount of time that can be wasted fighting this; I think it took me 5 days to understand the working parts of SSH, Linux, and Windows to finally solve this before I found the link to Microsoft OpenSSH repo. At least now I understand what is going on. I understand how to use ssh-agent to add my private key. I don’t use a private key without a password. My private key is heavily protected, and I think I know what I am doing around SSH now.</p>
<p><a href="https://code.visualstudio.com/">Visual Studio Code</a> (VSCode) was next. Technically, it was mixed into SSH, but we don’t have to get into that. Visual Studio Code is a great tool, but it is another thing to learn. It has a lot of working parts. It is a good editor with lots of functionality, including a Julia IDE with Remote SSH extension ( screenshot below). VSCode has around 120 keyboard shortcuts to learn. If you are going to use an IDE a lot, learn the shortcut keys. I decided to learn VSCode by learning the shortcut keys, so I made a Quizlet of all the shortcut keys here: <a href="https://quizlet.com/_987xud?x=1jqt&amp;i=3egxh1">Visual Studio Code Keyboard Shortcuts Quizlet</a>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://jasonhnicholson.com/posts/2020/12/unnamed.png" class="img-fluid figure-img"></p>
<figcaption>“Visual Studio Code SSH session to my server and Julia”</figcaption>
</figure>
</div>
<p>The Julia language, <a href="https://github.com/GenieFramework/Genie.jl">Genie.jl</a> package, and the <a href="https://github.com/GenieFramework/Stipple.jl">Stipple.jl</a> package was next. Julia is an up-and-coming scientific computing language. All around, it seems that it is a good computer science language. I have been using <a href="https://docs.julialang.org/en/v1/">Julia Documentation</a>, <a href="https://exercism.io/tracks/julia">Julia|Exercism</a>, <a href="https://quizlet.com/_98g8qm?x=1jqt&amp;i=3egxh1">Julia REPL Shortcut Keys, Key bindings Quizlet</a> (I created this), <a href="https://quizlet.com/_987w2e?x=1jqt&amp;i=3egxh1">Julia Visual Studio Code Shortcut Keys</a>, and the <a href="https://discourse.julialang.org/">Julia Discourse</a>. Exercism.com teaches through code by problem/challenge, which works well for me. Exercism allows me to look at other people’s solutions once I have submitted a solution. This is working for learning the Julia language. I am enjoying it. Quizlet is a great tool for memorizing lists. Julia Discourse is a great place to ask for help.</p>


</section>

 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2020/12/2020-12-31-ssh-windows-web-servers-linux-and-visual-studio-code.html</guid>
  <pubDate>Thu, 31 Dec 2020 05:00:00 GMT</pubDate>
</item>
<item>
  <title>Object-Oriented Programming Decline - The Rise of other Paradigms</title>
  <link>https://jasonhnicholson.com/posts/2020/11/2020-11-15-object-oriented-programming-decline-the-rise-of-other-paradigms.html</link>
  <description><![CDATA[ 





<p>I listen to a lot of computer science-related talks and podcasts. Recently, I have seen a trend away from the object-oriented paradigm. The premise is fusing your data and functions together is hard to maintain at scale. I agree. A better approach is only loosely to tie your data to the functions. I see this in the Julia language, for instance.</p>
<p>I watched several videos that led me to gather a little information on the issues. The first one was <a href="https://youtu.be/QyJZzq0v7Z4">Why Isn’t Functional Programming the Norm? – Richard Feldman</a>. He talks about why object-oriented programming came to be the norm in the ’90s and 2000s. The main reason he describes is Java. There is more to, but there isn’t a strong reason why the industry embraced object-oriented programming.</p>
<p>Next, the following video showed up in my YouTube feed: <a href="https://www.youtube.com/watch?v=QM1iUe6IofM">Object-Oriented Programming is Bad</a>. The title is severe, and the content is less severe. The main issue comes back to that fusing your data and methods together doesn’t scale well.</p>
<p>Lastly, I watched <a href="https://www.youtube.com/watch?v=kc9HwsxE1OY&amp;t=68s">JuliaCon 2019 | The Unreasonable Effectiveness of Multiple Dispatch | Stefan Karpinski</a> as I explore the Julia language. The Julia Language focuses on generic programming, which is amazing that the same code can be used for different data. Generic programming generally requires splitting the data out from the algorithm, which goes against object-oriented programming.</p>



 ]]></description>
  <guid>https://jasonhnicholson.com/posts/2020/11/2020-11-15-object-oriented-programming-decline-the-rise-of-other-paradigms.html</guid>
  <pubDate>Sun, 15 Nov 2020 05:00:00 GMT</pubDate>
</item>
</channel>
</rss>
